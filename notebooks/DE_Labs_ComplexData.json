{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Become familiar with complex type columns operations with both Hive and Impala\n**File locations:** s3://shared-edu/da\n**Successful outcome:** Understanding the use case for complex types\n**Before you begin:**\n**Related lessons:** Data Engineering with Hive\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:07:38+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928741_1424019727","id":"20171105-200834_1116095891","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:07:38+0000","dateFinished":"2022-03-24T10:07:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:53195"},{"text":"%md\n# Setup\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T09:59:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928741_1419200470","id":"20181114-164229_902436001","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T09:59:09+0000","dateFinished":"2022-03-24T09:59:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53196"},{"title":"Required for Kerberos ","text":"%sh\n\necho $PASS | kinit $USER","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:03:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648116195936_2094958735","id":"20220324-100315_206014075","dateCreated":"2022-03-24T10:03:15+0000","dateStarted":"2022-03-24T10:03:36+0000","dateFinished":"2022-03-24T10:03:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53197"},{"title":"Set up the data context","text":"%sh\n\nmkdir -p data\naws s3 cp s3://shared-edu/da/loyalty_data.txt data/loyalty_data.txt\nhdfs dfs -put data/loyalty_data.txt /tmp/raw\nhdfs dfs -chmod -R 777 /tmp/raw\nhdfs dfs -mkdir -p /tmp/dualcore\nhdfs dfs -chmod 777 /tmp/dualcore","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:12:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648116291428_-879450221","id":"20220324-100451_2101993358","dateCreated":"2022-03-24T10:04:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53198"},{"title":"Create the analyst database","text":"%jdbc(hive)\n\nDROP DATABASE If EXISTS analyst CASCADE;\nCREATE DATABASE analyst;\nUSE analyst;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:16:58+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648116926375_-1335630407","id":"20220324-101526_292443905","dateCreated":"2022-03-24T10:15:26+0000","dateStarted":"2022-03-24T10:16:46+0000","dateFinished":"2022-03-24T10:16:54+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53199"},{"text":"%md\n# Lab\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T09:59:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_-118943292","id":"20181114-164844_1661453681","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T09:59:18+0000","dateFinished":"2022-03-24T09:59:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53200"},{"text":"%md\n### Creating, Loading, and Querying Complex Data with Hive\n\nDualcore recently started a loyalty program to reward our best customers.\n\nA colleague has already provided us with a sample of the data that contains information about customers who have signed up for the program, including their phone numbers (as a MAP), a list of past order IDs (as an ARRAY), and a STRUCT that summarizes the minimum, maximum, average, and total value of past orders (in cents).\n\nYou will use Hive to create the table, populate it with the provided data, and then run a few queries to practice referencing these types of fields. \n\nFinally, you will create a Parquet table containing the same data, to allow you to use Impala to query the data.\nYou may use either the Beeline shell or Hue’s Hive Query Editor for these exercises.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T09:59:32+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_1389420305","id":"20220106-083212_1118016362","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T09:59:32+0000","dateFinished":"2022-03-24T09:59:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53201"},{"text":"%md\nIn the analyst database, create a text file-based table with the following characteristics:\n  \n**Name:** loyalty_program\n**Type:** EXTERNAL\n**Field Terminator:** | (pipe)\n**Collection Item Terminator:** , (comma)\n**Map Key Terminator:** : (colon)\n**Location:** /tmp/dualcore/loyalty_program \n**external.table.purge:**true\n**Columns:**\n* cust_id: INT\n* fname: STRING\n* lname: STRING\n* email: STRING\n* level: STRING\n* phone: MAP<STRING,STRING>\n* order_ids: ARRAY<INT>\n* order_value STRUCT<min: INT, max: INT, avg: INT, total: INT>","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:19:49+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_-447874760","id":"20220106-083431_779708119","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:19:49+0000","dateFinished":"2022-03-24T10:19:49+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53202"},{"title":"1- Create a text file-based table with the following characteristics","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:20:42+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_7137250","id":"20220106-085907_456482718","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:20:48+0000","dateFinished":"2022-03-24T10:20:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53203"},{"title":"2 - Examine the data in data/loyalty_data.txt to see how it maps to the table","text":"%sh\n\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:21:11+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_-726482883","id":"20220107-014501_1913906269","dateCreated":"2022-03-23T16:28:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53204"},{"title":"3 - Load the data in the loyalty_program table","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:31:50+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_-885391738","id":"20220107-020340_22607775","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:31:51+0000","dateFinished":"2022-03-24T10:31:51+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53205"},{"text":"%md\nRun a query to select the HOME phone number for customer ID 1200866. \n**Hint:** MAP keys are case-sensitive.\nYou should see 408-555-4914 as the result.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:33:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_-1990045130","id":"20220107-020851_1826712765","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:33:58+0000","dateFinished":"2022-03-24T10:33:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53206"},{"title":"4 - Run a query to select the HOME phone number for customer ID 1200866","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:36:30+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928742_-848599036","id":"20220107-020945_1584277873","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:36:35+0000","dateFinished":"2022-03-24T10:36:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53207"},{"text":"%md\nSelect the third element from the order_ids field (of ARRAY type) for customer ID 1200866. \n**Hint:** elements are indexed from zero.\nThe query should return 5278505.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:36:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928743_-1704239528","id":"20220107-021723_1705493002","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:36:51+0000","dateFinished":"2022-03-24T10:36:51+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53208"},{"title":"5- Select the third element from the order_ids field (of ARRAY type) for customer ID 1200866","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:36:55+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928743_2018861658","id":"20220107-021721_877418555","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:36:55+0000","dateFinished":"2022-03-24T10:36:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53209"},{"text":"%md\nSelect the total attribute from the order_value field (of STRUCT type) for customer ID 1200866. \nThe query should return 401874.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:37:01+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"results":{},"enabled":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928743_1477990712","id":"20220107-022056_318419476","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:37:01+0000","dateFinished":"2022-03-24T10:37:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53210"},{"title":"6 - Select the total attribute from the order_value field (of STRUCT type) for customer ID 1200866","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:37:06+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928743_467149862","id":"20220107-022054_13464370","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:37:09+0000","dateFinished":"2022-03-24T10:37:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53211"},{"text":"%md\n### Bonus Exercise 1: Hive Table-Generating Functions\nIf you have successfully finished the earlier steps and still have time, feel free to continue with this optional bonus exercise.\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:46:19+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928744_-896723957","id":"20220107-024406_1174543425","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:46:19+0000","dateFinished":"2022-03-24T10:46:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53212"},{"text":"%md\nRun a Hive query to return the order IDs for customer ID 1200866, one per row. \n**Hint:** Use the explode function.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:46:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928745_-1754314346","id":"20220107-024433_248767965","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:46:14+0000","dateFinished":"2022-03-24T10:46:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53213"},{"title":"7 - Run a Hive query to return the order IDs for customer ID 1200866, one per row","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:47:20+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928745_630954893","id":"20220107-024403_1790379166","dateCreated":"2022-03-23T16:28:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53214"},{"text":"%md\nRun a Hive query to return the customer IDs and order IDs for all customers who have an average order total of greater than $900 (90,000 cents). \nThe query should return one order ID per row.\n**Hint:** Use LATERAL VIEW.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:47:26+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928745_-1258897927","id":"20220107-024858_30684723","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:47:26+0000","dateFinished":"2022-03-24T10:47:26+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53215"},{"title":"8 - Run a Hive query to return the customer IDs and order IDs for all customers who have an average order total of greater than $900","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:48:08+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928745_-861623653","id":"20220107-024858_516319628","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:48:08+0000","dateFinished":"2022-03-24T10:48:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53216"},{"text":"%md\n# Result\n**You have now:** become familiar with complex type columns operations with Hive.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:22:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_-1167631747","id":"20181119-142716_792318228","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:21:56+0000","dateFinished":"2022-03-24T10:21:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53217"},{"text":"%md\n# Solution\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:20:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_-627230390","id":"20171113-155535_1769142099","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:20:08+0000","dateFinished":"2022-03-24T10:20:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53218"},{"title":"1- Create a text file-based table with the following characteristics","text":"%jdbc(hive)\n\nDROP TABLE IF EXISTS  analyst.loyalty_program;\n\nCREATE EXTERNAL TABLE analyst.loyalty_program\n   (cust_id INT,\n    fname STRING,\n    lname STRING,\n    email STRING,\n    level STRING,\n    phone MAP<STRING, STRING>,\n    order_ids ARRAY<INT>,\n    order_value STRUCT<min:INT,\n                       max:INT,\n                       avg:INT,\n                       total:INT>)\n   ROW FORMAT DELIMITED\n      FIELDS TERMINATED BY '|'\n      COLLECTION ITEMS TERMINATED BY ','\n      MAP KEYS TERMINATED BY ':'\n   STORED AS TEXTFILE\n   LOCATION '/tmp/dualcore/loyalty_program'\n   TBLPROPERTIES ('external.table.purge'='true');","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:20:12+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_-980267805","id":"20220106-085950_2077449876","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:20:13+0000","dateFinished":"2022-03-24T10:20:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53219"},{"title":"2 - Examine the data in data/loyalty_data.txt to see how it maps to the table","text":"%sh\n\nhead data/loyalty_data.txt","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:27:48+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_1219489811","id":"20220107-014648_781589781","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:26:31+0000","dateFinished":"2022-03-24T10:26:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53220"},{"title":"3 - Load the data in the loyalty_program table","text":"%jdbc(hive)\n\nLOAD DATA  INPATH '/tmp/raw/loyalty_data.txt' OVERWRITE INTO TABLE analyst.loyalty_program;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:31:26+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_1503847158","id":"20220107-020701_1757373092","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:31:08+0000","dateFinished":"2022-03-24T10:31:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53221"},{"title":"4 - Run a query to select the HOME phone number for customer ID 1200866","text":"%jdbc(hive)\n\nSELECT phone['HOME'] AS home FROM analyst.loyalty_program WHERE cust_id=1200866;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:32:58+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"home":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_3890548","id":"20220107-021008_746091965","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:32:58+0000","dateFinished":"2022-03-24T10:32:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53222"},{"title":"5- Select the third element from the order_ids field (of ARRAY type) for customer ID 1200866","text":"%jdbc(hive)\n\nSELECT order_ids[2] AS third FROM analyst.loyalty_program WHERE cust_id=1200866;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:33:14+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"third":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_-1184147703","id":"20220107-021832_100641784","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:33:25+0000","dateFinished":"2022-03-24T10:33:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53223"},{"title":"6 - Select the total attribute from the order_value field (of STRUCT type) for customer ID 1200866","text":"%jdbc(hive)\n\nSELECT order_value.total FROM analyst.loyalty_program WHERE cust_id=1200866;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:37:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"total":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928746_819870503","id":"20220107-022240_1440507893","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:37:28+0000","dateFinished":"2022-03-24T10:37:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53224"},{"title":"7 - Run a Hive query to return the order IDs for customer ID 1200866, one per row","text":"%jdbc(hive)\n\nSELECT explode(order_ids) AS orderid FROM analyst.loyalty_program WHERE cust_id=1200866;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:53:04+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"orderid":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928747_993362246","id":"20220107-024750_1911255325","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:53:07+0000","dateFinished":"2022-03-24T10:53:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53225"},{"title":"8 - Run a Hive query to return the customer IDs and order IDs for all customers who have an average order total of greater than $900","text":"%jdbc(hive)\n\nSELECT cust_id, order_id\n  FROM analyst.loyalty_program\n    LATERAL VIEW explode(order_ids) o AS order_id\n  WHERE order_value.avg > 90000;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:53:12+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"cust_id":"string","order_id":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928747_301381714","id":"20220107-025009_296334797","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:53:13+0000","dateFinished":"2022-03-24T10:53:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53226"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:53:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928748_982583735","id":"20181116-135131_93712280","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:53:31+0000","dateFinished":"2022-03-24T10:53:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53227"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T10:53:53+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928748_-741700114","id":"20200110-154537_1406191376","dateCreated":"2022-03-23T16:28:48+0000","dateStarted":"2022-03-24T10:53:53+0000","dateFinished":"2022-03-24T10:53:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53228"},{"text":"%angular\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-23T16:28:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648052928748_-1339521931","id":"20200110-162013_302547143","dateCreated":"2022-03-23T16:28:48+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53229"}],"name":"DE/Labs/ComplexData","id":"2GXU39T9B","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}