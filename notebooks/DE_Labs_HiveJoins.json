{"paragraphs":[{"text":"%md\n# About\n**Lab:** Hive Joins\n**Objective:** Become familiar with using Hive joins\n**File locations:** /tmp/data/\n**Successful outcome:** Understanding hive Joins\n**Before you begin:** N/A\n**Related lessons:** Transforming Data with Hive\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:28:23+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403171_-1773128384","id":"20181126-092644_1457476546","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:28:24+0000","dateFinished":"2022-03-22T16:28:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4759"},{"text":"%md\n# Setup","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:28:24+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403173_-1520537111","id":"20181201-044336_178705192","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:28:25+0000","dateFinished":"2022-03-22T16:28:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4760"},{"title":"Required for Kerberos operations","text":"%sh\n\necho $PASS | kinit $USER","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:28:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true,"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958531118_761429394","id":"20220322-141531_1803804996","dateCreated":"2022-03-22T14:15:31+0000","dateStarted":"2022-03-22T16:28:38+0000","dateFinished":"2022-03-22T16:28:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4761"},{"title":"Retrieve the files from IMDb","text":"%sh\n\nrm -r tmp\nmkdir -p tmp\ncd tmp\nwget -nv https://datasets.imdbws.com/title.basics.tsv.gz\nwget -nv https://datasets.imdbws.com/title.crew.tsv.gz\nwget -nv https://datasets.imdbws.com/name.basics.tsv.gz\nwget -nv https://datasets.imdbws.com/title.ratings.tsv.gz\ngunzip title.basics.tsv.gz\ngunzip title.crew.tsv.gz\ngunzip name.basics.tsv.gz\ngunzip title.ratings.tsv.gz\nls -l","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:28:38+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403174_-1249975423","id":"20191018-101805_1346904148","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:28:39+0000","dateFinished":"2022-03-22T16:28:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4762"},{"title":"Clean Database and HDFS Folders","text":"%jdbc(hive)\n\ndrop database if exists movies cascade;\ncreate database movies;\nuse movies;","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:28:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958654688_-1439419719","id":"20220322-141734_1827722093","dateCreated":"2022-03-22T14:17:34+0000","dateStarted":"2022-03-22T16:28:56+0000","dateFinished":"2022-03-22T16:29:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4763"},{"title":"Copy the data in HDFS","text":"%sh\n\nhdfs dfs -rm -r /tmp/raw\nhdfs dfs -mkdir -p /tmp/raw\nhdfs dfs -put -f tmp/title.basics.tsv /tmp/raw/\nhdfs dfs -put -f tmp/title.crew.tsv /tmp/raw/\nhdfs dfs -put -f tmp/name.basics.tsv /tmp/raw/\nhdfs dfs -put -f tmp/title.ratings.tsv /tmp/raw/\nhdfs dfs -chmod -R 777 /tmp/raw/\nhdfs dfs -mkdir -p /tmp/movies\nhdfs dfs -chmod -R 777 /tmp/movies","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:29:09+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403175_-1181545923","id":"20190606-132331_1529571930","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:29:10+0000","dateFinished":"2022-03-22T16:29:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4764"},{"title":"Create the movies database","text":"%jdbc(hive)\n\n-- Contains the following information for titles\nCREATE EXTERNAL TABLE movie_title (\n                        tconst string,\n                        titleType string,\n                        primaryTitle string,\n                        originalTitle string,\n                        isAdult string,\n                        startYear string,\n                        endYear string,\n                        runtimeMinutes string,\n                        genres ARRAY<STRING>\n                        ) ROW FORMAT DELIMITED\nFIELDS TERMINATED BY '\\t' \nLOCATION '/tmp/movies/movie_title/'\nTBLPROPERTIES ('external.table.purge'='true');\n\n-- Load data\nLOAD DATA  INPATH '/tmp/raw/title.basics.tsv' OVERWRITE INTO TABLE movie_title;\n\n-- Remove header for movie_title\nALTER TABLE movie_title SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n\n-- Contains the information for directors and writers\nCREATE EXTERNAL TABLE movie_crew(\n                        tconst string,\n                        directors ARRAY<STRING>,\n                        writers ARRAY<STRING>\n                        ) ROW FORMAT DELIMITED\nFIELDS TERMINATED BY '\\t'\nLOCATION '/tmp/movies/movie_crew/'\nTBLPROPERTIES ('external.table.purge'='true');\n\n-- Load data movie_crew\nLOAD DATA  INPATH '/tmp/raw/title.crew.tsv' OVERWRITE INTO TABLE movie_crew;\n\n-- Remove header for movie_crew\nALTER TABLE movie_crew SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n-- Contains the information for names\nCREATE EXTERNAL TABLE movie_crew_info(\n                        nconst string,\n                        primaryName string,\n                        birthYear string,\n                        deathYear string,\n                        primaryProfession ARRAY<STRING>,\n                        knownForTitles ARRAY<STRING>\n                        ) ROW FORMAT DELIMITED\nFIELDS TERMINATED BY '\\t' \nLOCATION '/tmp/movies/movie_crew_info/'\nTBLPROPERTIES ('external.table.purge'='true');\n\n-- Load data movie_crew_info\nLOAD DATA  INPATH '/tmp/raw/name.basics.tsv' OVERWRITE INTO TABLE movie_crew_info;\n\n-- Remove header for movie_crew_info\nALTER TABLE movie_crew_info SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");\n\n\n-- Ratings and vote information for titles\nCREATE EXTERNAL TABLE ratings(\n                        tconst string,\n                        averageRting double,\n                        numVotes int\n                        ) ROW FORMAT DELIMITED\nFIELDS TERMINATED BY '\\t' \nLOCATION '/tmp/movies/ratings/'\nTBLPROPERTIES ('external.table.purge'='true');\n\n\n-- Load data ratings\nLOAD DATA  INPATH '/tmp/raw/title.ratings.tsv' OVERWRITE INTO TABLE ratings;\n\n-- Remove header for ratings\nALTER TABLE ratings SET TBLPROPERTIES (\"skip.header.line.count\"=\"1\");","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:29:28+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403175_-306334881","id":"20190606-132416_510216579","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:29:29+0000","dateFinished":"2022-03-22T16:29:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4765"},{"text":"%md\n# Lab\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:29:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403176_-1318337568","id":"20181126-093358_358613711","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:29:35+0000","dateFinished":"2022-03-22T16:29:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4766"},{"text":"%md\nWe are going to use the new movie database. You can do a describe on the tables.\n\n~~~\nuse movies;\ndescribe movie_title;\ndescribe movie_crew;\ndescribe movie_crew_info;\ndescribe ratings;\n~~~\n\nReview the tables to determine keys to join.","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403177_-941610603","id":"20181201-173003_1022275665","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:29:35+0000","dateFinished":"2022-03-22T16:29:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4767"},{"title":"1 - Use movies database and create a join for  the movie_title and rating tables. Show the title type, primary title ,original title and average rating. (Limit 5 rows)","text":"","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403177_668619634","id":"20181126-094403_539011278","dateCreated":"2022-03-22T14:13:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4768"},{"title":"2 - Join the movie_crew_info table to the movie_crew table. Display the Title Type, Original Title, Movie Title, Start Year, Primary name of crew member, crew member birth year and primary profession. ( Hint:You may need to use the substring UDF on the table keys.)","text":"","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:29:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403178_-666808767","id":"20181018-110639_553156023","dateCreated":"2022-03-22T14:13:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4769"},{"title":"3 - Execute Explain Plans on Join statements","text":"","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403179_-2005612952","id":"20181126-095334_1706920776","dateCreated":"2022-03-22T14:13:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4770"},{"text":"%md\nWe are going to create a materialized view using a table join.\n\n~~~\nCreate a materialized view  mv_movie_ratings that joins tables movie_title and rating. \nInclude only the movies that have a start year after 2001 and an average rating greater than 5.5. (Limit to 5 rows.) \n~~~\n\nBut first we need to create managed versions of the movie_title and ratings tables because Hive won't let us create a materialized view from external tables. This helps Hive know when the materialized view is stale and needs to be rebuilt.","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:01+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403180_-1966092732","id":"20181203-225219_1680906315","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:30:01+0000","dateFinished":"2022-03-22T16:30:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4771"},{"title":"4- Create managed versions of the movie_title and ratings tables","text":"\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:01+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647965983983_667083615","id":"20220322-161943_2102381191","dateCreated":"2022-03-22T16:19:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4772"},{"text":"%md\nWe need to drop the materialized view if it already exists.","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647966219043_-671463107","id":"20220322-162339_900111648","dateCreated":"2022-03-22T16:23:39+0000","dateStarted":"2022-03-22T16:30:05+0000","dateFinished":"2022-03-22T16:30:05+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4773"},{"title":"5 - Drop and Create the materialized view","text":"\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403181_-849916101","id":"20181204-010437_1605522409","dateCreated":"2022-03-22T14:13:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4774"},{"title":"6 - Execute a Query on the materialized view","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403182_-239212215","id":"20181216-023545_1023157428","dateCreated":"2022-03-22T14:13:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4775"},{"text":"%md\n###Optional Challenge:\nTry to join the movie_title, rating and movie_crew and movie_crew_info","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403183_716757067","id":"20181217-205332_741870945","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:30:19+0000","dateFinished":"2022-03-22T16:30:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4776"},{"title":"Optional Challenge:","text":"\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:19+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403183_-1258542691","id":"20181217-205355_605112851","dateCreated":"2022-03-22T14:13:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4777"},{"text":"%md\n# Result\n**You have now:** You have now successfully created a join in Hive\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403184_-2117225385","id":"20181126-133507_1472573213","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:30:20+0000","dateFinished":"2022-03-22T16:30:20+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4778"},{"text":"%md\n# Solution\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403185_1264681029","id":"20181018-125200_1133281582","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:30:33+0000","dateFinished":"2022-03-22T16:30:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4779"},{"title":"1 - Use movies database and create a join for movie_title and rating title using the tconst key. Show the title type, primary title ,original title and average rating(Limit 5 rows)","text":"%jdbc(hive)\n\nSELECT movie_title.titleType, movie_title.primaryTitle, movie_title.originalTitle, ratings.averageRting \nFROM movie_title JOIN ratings ON (movie_title.tconst=ratings.tconst) LIMIT 5;\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:30:33+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_title.titletype":"string","movie_title.primarytitle":"string","movie_title.originaltitle":"string","ratings.averagerting":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"3":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403186_348966746","id":"20181018-110338_1899474794","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:30:33+0000","dateFinished":"2022-03-22T16:32:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4780"},{"title":"2 - Join the movie_crew_info table to the movie_crew table. Display the Title Type, Original Title, Movie Title, Start Year, Primary name of crew member, crew member birth year and primary profession. ( Hint:You may need to use the substring UDF on the table keys.)","text":"%jdbc(hive)\n\nSELECT movie_title.titleType,movie_title.originalTitle,movie_title.startYear, movie_Crew_info.primaryname,movie_crew_info.birthyear,movie_crew_info.primaryprofession \nFROM movie_title JOIN movie_crew_info \nON (SUBSTR(movie_title.tconst,3,9) = SUBSTR(movie_crew_info.nconst,3,9)) LIMIT 5;\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:32:09+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"movie_title.titletype":"string","movie_title.originaltitle":"string","movie_title.startyear":"string","movie_crew_info.primaryname":"string","movie_crew_info.birthyear":"string","movie_crew_info.primaryprofession":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}},"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403187_-1736438590","id":"20181126-094450_1417148698","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:32:10+0000","dateFinished":"2022-03-22T16:32:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4781"},{"title":"3 - Execute Explain Plans on Join statements ","text":"%jdbc(hive)\n\nExplain SELECT movie_title.titleType, movie_title.primaryTitle, movie_title.originalTitle, ratings.averageRting \nFROM movie_title JOIN ratings ON (movie_title.tconst=ratings.tconst) LIMIT 5;\n\nExplain SELECT movie_title.titleType,movie_title.originalTitle,movie_title.startYear, movie_Crew_info.primaryname,movie_crew_info.birthyear,movie_crew_info.primaryprofession \nFROM movie_title JOIN movie_crew_info \nON (SUBSTR(movie_title.tconst,3,9) = SUBSTR(movie_crew_info.nconst,3,9)) LIMIT 5;\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:32:41+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dc_comics_acid_insert.page_id":"string","dc_comics_acid_insert.name":"string","dc_comics_acid_insert.urlslug":"string","dc_comics_acid_insert.id":"string","dc_comics_acid_insert.align":"string","dc_comics_acid_insert.eye":"string","dc_comics_acid_insert.hair":"string","dc_comics_acid_insert.sex":"string","dc_comics_acid_insert.gsm":"string","dc_comics_acid_insert.alive":"string","dc_comics_acid_insert.appearances":"string","dc_comics_acid_insert.first_appearances":"string","dc_comics_acid_insert.year":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403188_61975182","id":"20181018-110637_1031040934","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:32:47+0000","dateFinished":"2022-03-22T16:32:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4782"},{"title":"4- Create managed versions of the movie_title and ratings tables","text":"%jdbc(hive)\n\nDROP TABLE movies.int_movie_title;\nCREATE TABLE movies.int_movie_title AS SELECT * FROM movies.movie_title;\nDROP TABLE movies.int_ratings;\nCREATE TABLE movies.int_ratings AS SELECT * FROM movies.ratings;\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:32:47+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647961451243_-699161756","id":"20220322-150411_173034282","dateCreated":"2022-03-22T15:04:11+0000","dateStarted":"2022-03-22T16:32:48+0000","dateFinished":"2022-03-22T16:35:30+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4783"},{"title":"5 - Drop and Create the materialized view ","text":"%jdbc(hive)\n\nDROP materialized view IF exists movies.mv_movie_ratings;\nCREATE materialized view IF NOT EXISTS movies.mv_movie_ratings  AS \nSELECT  int_movie_title.titleType, \n        int_movie_title.primaryTitle, \n        int_movie_title.originalTitle, \n        int_ratings.averageRting \nFROM int_movie_title\nJOIN int_ratings ON (int_movie_title.tconst=int_ratings.tconst) \nWHERE int_movie_title.startYear> 2001 AND int_ratings.averageRting >5.5;\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:35:30+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"col_name":"string","data_type":"string","comment":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403189_-102636102","id":"20181018-111736_1626489692","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:35:44+0000","dateFinished":"2022-03-22T16:37:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4784"},{"title":"6 - Execute a Query on the materialized view","text":"%jdbc(hive)\n\nSELECT * FROM movies.mv_movie_ratings LIMIT 5;\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:37:35+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"mv_movie_ratings.titletype":"string","mv_movie_ratings.primarytitle":"string","mv_movie_ratings.originaltitle":"string","mv_movie_ratings.averagerting":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403190_1458688361","id":"20181216-031305_1172702300","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:37:45+0000","dateFinished":"2022-03-22T16:37:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4785"},{"title":"Additional resources","text":"%md\n\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:37:45+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403191_-388793822","id":"20181126-133017_244739700","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:37:46+0000","dateFinished":"2022-03-22T16:37:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4786"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:37:46+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403192_-386797977","id":"20181126-133854_534346231","dateCreated":"2022-03-22T14:13:23+0000","dateStarted":"2022-03-22T16:37:47+0000","dateFinished":"2022-03-22T16:37:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4787"},{"text":"%angular\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-22T16:37:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1647958403193_1396803821","id":"20190606-133136_1603050175","dateCreated":"2022-03-22T14:13:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:4788"}],"name":"DE/Labs/HiveJoins","id":"2GY7AMV8Y","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}