{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Become familiar with Spark complex types operations\n**File locations:** s3://shared-edu/sci/\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Working with DataFrames\n\nCopyright © 2010–2021 Cloudera. All rights reserved.\nNot to be reproduced or shared without prior written consent from Cloudera.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831915_1085567413","id":"20171105-200834_1116095891","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:09+0000","dateFinished":"2022-01-24T16:00:09+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:112971"},{"text":"%md\n## Overview\n\nIn this module we consider the complex collection data types provided bySpark SQL: arrays, maps, and structs.\nWe show how to construct and transform columns with complex collection data types.\n\n\n## Complex Collection Data Types\n\n* Complex collection data types provide a way to renormalize the denormalized data that is common in the big-data world\n\n* The complex collection data types are defined in the `pyspark.sql.types` module:\n    * The *ArrayType* represents a variable-length collection of elements\n    * The *MapType* represents a variable-length collection of key-value pairs\n    * The *StructType* represents a fixed-length collection of named elements\n\n* Complex collection data types are obtained in several ways:\n    * Inherited from Hive/Impala tables\n    * Inferred from nested JSON files\n    * Generated by aggregate functions such as `collect_list` and `collect_set`\n    * Constructed manually","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:09+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831916_-702076339","id":"20210609-214236_1622006817","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:10+0000","dateFinished":"2022-01-24T16:00:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112972"},{"text":"%md\n# Setup\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831916_-304265231","id":"20181114-164229_902436001","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:11+0000","dateFinished":"2022-01-24T16:00:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112973"},{"title":"Required for Kerberos operations","text":"%sh\n\necho $PASS | kinit $USER","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039920747_932640558","id":"20220124-155840_1918018434","dateCreated":"2022-01-24T15:58:40+0000","dateStarted":"2022-01-24T16:00:12+0000","dateFinished":"2022-01-24T16:00:12+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112974"},{"title":"Setup the data context","text":"%sh\n\nrm -rf data\nmkdir -p data\naws s3 cp --recursive s3://shared-edu/sci/duocar/raw data/raw\nhdfs dfs -mkdir -p duocar\nhdfs dfs -put -f data duocar","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039975192_-1959307558","id":"20220124-155935_1393393342","dateCreated":"2022-01-24T15:59:35+0000","dateStarted":"2022-01-24T16:00:13+0000","dateFinished":"2022-01-24T16:00:22+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112975"},{"title":"Read the raw data from HDFS","text":"%spark\n\nval rides = spark.read.option(\"header\",\"true\").option(\"inferShema\",\"true\").csv(\"duocar/raw/rides/\")\nval drivers = spark.read.option(\"header\",\"true\").option(\"inferShema\",\"true\").csv(\"duocar/raw/drivers/\")\nval riders = spark.read.option(\"header\",\"true\").option(\"inferShema\",\"true\").csv(\"duocar/raw/riders/\")","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831917_-1256414708","id":"20210609-214604_1208392134","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:23+0000","dateFinished":"2022-01-24T16:00:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112976"},{"text":"%md\n# Lesson\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:24+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831918_540562935","id":"20210609-150445_381117564","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:25+0000","dateFinished":"2022-01-24T16:00:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112977"},{"text":"%md\n## Arrays","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831918_1189055608","id":"20210609-214808_2124581014","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:26+0000","dateFinished":"2022-01-24T16:00:26+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112978"},{"title":"Use the array function to create an array from multiple columns","text":"%spark\n\nimport org.apache.spark.sql.functions.{array}\nval drivers_array = (drivers.withColumn(\"vehicle_array\", array(\"vehicle_make\", \"vehicle_model\"))\n                            .select(\"vehicle_make\", \"vehicle_model\", \"vehicle_array\"))\ndrivers_array.printSchema()\ndrivers_array.show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831919_267490458","id":"20210609-214950_490436151","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:27+0000","dateFinished":"2022-01-24T16:00:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112979"},{"title":"Use index notation to access elements of the array","text":"%spark\n\nimport org.apache.spark.sql.functions.{col}\n\ndrivers_array.select($\"vehicle_array\", col(\"vehicle_array\").getItem(0)).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831919_1107069134","id":"20210609-215139_462878767","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:29+0000","dateFinished":"2022-01-24T16:00:30+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112980"},{"title":"Use the size function to get the length of the array","text":"%spark\n\nimport org.apache.spark.sql.functions.{size}\n\ndrivers_array.select($\"vehicle_array\", size($\"vehicle_array\")).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831920_-1709346778","id":"20210609-215230_879633660","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:31+0000","dateFinished":"2022-01-24T16:00:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112981"},{"title":"Use the sort_array function to sort the array","text":"%spark\n\nimport org.apache.spark.sql.functions.{sort_array}\n\ndrivers_array.select($\"vehicle_array\", sort_array($\"vehicle_array\", true)).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831921_-1736895197","id":"20210609-215326_1600236400","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:33+0000","dateFinished":"2022-01-24T16:00:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112982"},{"title":"Use the `array_contains` function to search the array","text":"%spark\n\nimport org.apache.spark.sql.functions.{array_contains}\n\ndrivers_array.select($\"vehicle_array\", array_contains($\"vehicle_array\", \"Subaru\")).show(5, false)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831921_-417526037","id":"20210609-215508_1658632882","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:35+0000","dateFinished":"2022-01-24T16:00:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112983"},{"title":"Use the `explode` and `posexplode` functions to explode the array","text":"%spark\n\nimport org.apache.spark.sql.functions.{explode, posexplode}\n\ndrivers_array.select($\"vehicle_array\", explode($\"vehicle_array\")).show(5,false)\ndrivers_array.select($\"vehicle_array\", posexplode($\"vehicle_array\")).show(5,false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:36+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831922_1411462894","id":"20210609-215631_592611552","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:37+0000","dateFinished":"2022-01-24T16:00:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112984"},{"text":"%md\n## Maps","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:38+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831922_-572053246","id":"20210609-214825_941697596","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:39+0000","dateFinished":"2022-01-24T16:00:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112985"},{"title":"Use the create_map function to create a map","text":"%spark\n\nimport org.apache.spark.sql.functions.{lit, map}\n\nval drivers_map = (drivers \n  .withColumn(\"vehicle_map\", map(lit(\"make\"), $\"vehicle_make\", lit(\"model\"), $\"vehicle_model\"))\n  .select(\"vehicle_make\", \"vehicle_model\", \"vehicle_map\"))\ndrivers_map.printSchema()\ndrivers_map.show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831923_-289774490","id":"20210609-215809_1949067261","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:40+0000","dateFinished":"2022-01-24T16:00:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112986"},{"title":"Use getItem to access a value by position","text":"%spark\n\nimport org.apache.spark.sql.functions.{lit, map_values}\n\ndrivers_map.select($\"vehicle_map\", map_values(col(\"vehicle_map\")).getItem(0)).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831924_-1657315900","id":"20210609-215929_1972517761","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:42+0000","dateFinished":"2022-01-24T16:00:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112987"},{"title":"Use the `size` function to get the length of the map","text":"%spark\n\ndrivers_map.select($\"vehicle_map\", size($\"vehicle_map\")).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831924_-150021270","id":"20210609-220011_2145852577","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:44+0000","dateFinished":"2022-01-24T16:00:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112988"},{"title":"Use the `explode` and `posexplode` functions to explode the map","text":"%spark\n\ndrivers_map.select($\"vehicle_map\", explode($\"vehicle_map\")).show(5, false)\ndrivers_map.select($\"vehicle_map\", posexplode($\"vehicle_map\")).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831925_-1242478896","id":"20210609-220050_526377266","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:47+0000","dateFinished":"2022-01-24T16:00:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112989"},{"text":"%md\n## Structs","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:48+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831925_256715607","id":"20210609-214847_1367988366","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:49+0000","dateFinished":"2022-01-24T16:00:49+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112990"},{"title":"Use the struct function to create a struct","text":"%spark\n\nimport org.apache.spark.sql.functions.{struct}\n\nval drivers_struct = (drivers \n  .withColumn(\"vehicle_struct\", struct(col(\"vehicle_make\").alias(\"make\"), col(\"vehicle_model\").alias(\"model\")))\n  .select(\"vehicle_make\", \"vehicle_model\", \"vehicle_struct\"))\ndrivers_struct.printSchema()\ndrivers_struct.show(5, false)\ndrivers_struct.head(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831926_-672852682","id":"20210609-220250_300408590","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:50+0000","dateFinished":"2022-01-24T16:00:51+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112991"},{"title":"Note","text":"%md\nThe struct is a `Row` object (embedded in a `Row` object).","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831927_-386366652","id":"20210609-220428_2046707505","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:52+0000","dateFinished":"2022-01-24T16:00:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112992"},{"title":"Use dot notation to access struct elements","text":"%spark\n\n(drivers_struct\n  .select(\"vehicle_struct\", \"vehicle_struct.make\")\n  .show(5, false))","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:52+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831927_1323658995","id":"20210625-140807_1147580554","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:53+0000","dateFinished":"2022-01-24T16:00:55+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112993"},{"title":"Use the `to_json` function to convert the struct to a JSON string","text":"%spark\n\nimport org.apache.spark.sql.functions.{to_json}\n\ndrivers_struct.select($\"vehicle_struct\", to_json($\"vehicle_struct\")).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:55+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831928_-1599406838","id":"20210609-220533_1798862611","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:56+0000","dateFinished":"2022-01-24T16:00:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112994"},{"text":"%md\n# Lab\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831929_-1565542529","id":"20210609-150527_79851234","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:00:58+0000","dateFinished":"2022-01-24T16:00:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112995"},{"title":"1 - Create an array called `home_array` that includes the driver's home latitude and longitude","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:00:58+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831930_1173419612","id":"20210609-221114_987659308","dateCreated":"2022-01-24T15:57:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112996"},{"title":"2 - Create a map called `name_map` that includes the driver's first and last name","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:00+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831930_-947619933","id":"20210609-221146_1508826613","dateCreated":"2022-01-24T15:57:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112997"},{"title":"3 - Create a struct called `name_struct` that includes the driver's first # and last name","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:01+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831931_-1995572848","id":"20210609-221144_10985682","dateCreated":"2022-01-24T15:57:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112998"},{"text":"%md\n# Result\n**You have now:** become familiar with Spark complex types operations\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831932_201135721","id":"20181119-142716_792318228","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:02+0000","dateFinished":"2022-01-24T16:01:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112999"},{"text":"%md\n# Solution\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831933_397285143","id":"20171113-155535_1769142099","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:04+0000","dateFinished":"2022-01-24T16:01:04+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113000"},{"title":"1 - Create an array called `home_array` that includes the driver's home latitude and longitude","text":"%spark\n\nimport org.apache.spark.sql.functions.{array}\n\nval drivers_array = drivers.withColumn(\"home_array\", array(\"home_lat\", \"home_lon\"))\ndrivers_array.select(\"home_lat\", \"home_lon\", \"home_array\").show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831933_-1176406014","id":"20210609-221342_1618027877","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:05+0000","dateFinished":"2022-01-24T16:01:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113001"},{"title":"2 - Create a map called `name_map` that includes the driver's first and last name","text":"%spark\n\nimport org.apache.spark.sql.functions.{lit, map}\n\nval drivers_map = drivers.withColumn(\"name_map\", map(lit(\"first\"), $\"first_name\", lit(\"last\"), $\"last_name\"))\ndrivers_map.select(\"first_name\", \"last_name\", \"name_map\").show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831934_620815726","id":"20210609-221423_1874248249","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:07+0000","dateFinished":"2022-01-24T16:01:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113002"},{"title":"3 - Create a struct called `name_struct` that includes the driver's first # and last name","text":"%spark\n\nimport org.apache.spark.sql.functions.{col, struct}\nval drivers_struct = drivers.withColumn(\"name_struct\", struct(col(\"first_name\").alias(\"first\"), col(\"last_name\").alias(\"last\")))\n\nimport org.apache.spark.sql.functions.{to_json}\ndrivers_struct.select($\"first_name\", $\"last_name\", $\"name_struct\", to_json($\"name_struct\")).show(5, false)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831935_-1501781601","id":"20210609-221431_532662891","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:09+0000","dateFinished":"2022-01-24T16:01:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113003"},{"title":"References","text":"%md\n\n* [Spark Python API - pyspark.sql.functions.array](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.types.ArrayType.html#pyspark.sql.types.ArrayType)\n\n* [Spark Python API - pyspark.sql.functions.create_map](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.types.MapType.html#pyspark.sql.types.MapType)\n\n* [Spark Python API - pyspark.sql.functions.struct](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.types.StructType.html#pyspark.sql.types.StructType)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831937_2052689331","id":"20210609-220720_2066698488","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:11+0000","dateFinished":"2022-01-24T16:01:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113004"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831938_267279664","id":"20181116-135131_93712280","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:12+0000","dateFinished":"2022-01-24T16:01:12+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113005"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:12+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831939_1440670301","id":"20200110-154537_1406191376","dateCreated":"2022-01-24T15:57:11+0000","dateStarted":"2022-01-24T16:01:13+0000","dateFinished":"2022-01-24T16:01:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113006"},{"text":"%angular\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T16:01:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039831939_545377957","id":"20200110-162013_302547143","dateCreated":"2022-01-24T15:57:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113007"}],"name":"DE/Labs/Scala/WorkingWithComplexTypes","id":"2GSNHYR29","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}