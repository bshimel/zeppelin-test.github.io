{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Become familiar with DataFrame columns transformations\n**File locations:** s3://shared-edu/sci/\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Working with DataFrames\n\nCopyright © 2010–2021 Cloudera. All rights reserved.\nNot to be reproduced or shared without prior written consent from Cloudera.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055676_318414750","id":"20171105-200834_1116095891","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:05+0000","dateFinished":"2022-01-24T15:47:05+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:65701"},{"text":"%md\n## Overview\n\nSpark SQL supports various column types and provides a variety of functions and Column methods that can be applied to each type. \nIn this module we demonstrate how to transform DataFrame columns of various types.\n\n* Working with numerical columns\n* Working with string columns\n* Working with datetime columns\n* Working with Boolean columns\n\n\n## Spark SQL Data Types\n\n* Spark SQL data types are defined in the `pyspark.sql.types` module\n\n* Spark SQL supports the following basic data types:\n    * NullType\n    * StringType\n    * Byte array data type\n        * BinaryType\n    * BooleanType\n    * Integer data types\n        * ByteType\n        * ShortType\n        * IntegerType\n        * LongType\n    * Fixed-point data type\n        * DecimalType\n    * Floating-point data types\n        * FloatType\n        * DoubleType\n    * Date and time data types\n        * DateType\n        * TimestampType\n\n* Spark also supports the following complex (collection) types:\n    * ArrayType\n    * MapType\n    * StructType\n\n* Spark SQL provides various methods and functions that can be applied to the various data types","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055677_-2087228614","id":"20210609-184255_683450783","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:05+0000","dateFinished":"2022-01-24T15:47:05+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65702"},{"text":"%md\n# Setup\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:05+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055678_1455832546","id":"20181114-164229_902436001","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:06+0000","dateFinished":"2022-01-24T15:47:06+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65703"},{"title":"Required for Kerberos operations","text":"%sh\n\necho $PASS | kinit $USER","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039156502_-1628834860","id":"20220124-154556_1811787416","dateCreated":"2022-01-24T15:45:56+0000","dateStarted":"2022-01-24T15:47:07+0000","dateFinished":"2022-01-24T15:47:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65704"},{"title":"Setup the data context","text":"%sh\n\nrm -rf data\nmkdir -p data\naws s3 cp --recursive s3://shared-edu/sci/duocar/raw data/raw\nhdfs dfs -mkdir -p duocar\nhdfs dfs -put -f data duocar","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039185843_-1286875741","id":"20220124-154625_705157928","dateCreated":"2022-01-24T15:46:25+0000","dateStarted":"2022-01-24T15:47:08+0000","dateFinished":"2022-01-24T15:47:17+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65705"},{"title":"Read the raw data from HDFS","text":"%spark\n\nval rides = spark.read.option(\"header\",\"true\").option(\"inferShema\",\"true\").csv(\"duocar/raw/rides/\")\nval drivers = spark.read.option(\"header\",\"true\").option(\"inferShema\",\"true\").csv(\"duocar/raw/drivers/\")\nval riders = spark.read.option(\"header\",\"true\").option(\"inferShema\",\"true\").csv(\"duocar/raw/riders/\")\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:17+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055679_-426982801","id":"20210609-185436_1594555073","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:18+0000","dateFinished":"2022-01-24T15:47:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65706"},{"text":"%md\n# Lesson\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:19+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055679_584762538","id":"20210609-150445_381117564","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:20+0000","dateFinished":"2022-01-24T15:47:20+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65707"},{"text":"%md\n## Working with numerical columns","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055680_-189877357","id":"20210609-185536_2039642717","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:21+0000","dateFinished":"2022-01-24T15:47:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65708"},{"title":"Example 1: Converting ride distance from meters to miles","text":"%spark\n\nimport org.apache.spark.sql.functions.{col, round}\n\nrides.select($\"distance\", round(col(\"distance\") / 1609.344, 2).alias(\"distance_in_miles\")).show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:22+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055681_-1233666689","id":"20210609-185831_522948905","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:23+0000","dateFinished":"2022-01-24T15:47:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65709"},{"title":"Notes","text":"%md\n* We have used the fact that 1 mile = 1609.344 meters.\n* We have used the `round` function to round the result to two decimal places.\n* We have used the `alias` method to rename the column.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:24+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055681_139454895","id":"20210609-185930_1633043121","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:24+0000","dateFinished":"2022-01-24T15:47:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65710"},{"title":"To add a new column, use the `withColumn` method with a new column name","text":"%spark\n\nrides.withColumn(\"distance_in_miles\", round(col(\"distance\") / 1609.344, 2)).printSchema()","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055682_-336224376","id":"20210609-190109_437353810","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:26+0000","dateFinished":"2022-01-24T15:47:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65711"},{"title":"To replace an existing column, use the `withColumn` method with an existing column name","text":"%spark\n\nrides.withColumn(\"distance\", round(col(\"distance\") / 1609.344, 2)).printSchema()","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055683_-1684548449","id":"20210609-190200_1937006490","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:28+0000","dateFinished":"2022-01-24T15:47:29+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65712"},{"title":"Example 2: Converting the ride id from an integer to a string","text":"%spark\n\n// Use the `format_string` function to convert `id` to a left-zero-padded string:\nimport org.apache.spark.sql.functions.{format_string}\n\nrides.withColumn(\"id_fixed\", format_string(\"%010d\", col(\"id\").cast(\"int\"))).select(\"id\", \"id_fixed\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:29+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055683_-1237108536","id":"20210609-190422_564835181","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:30+0000","dateFinished":"2022-01-24T15:47:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65713"},{"title":"Note","text":"%md\nWe have used the [printf format string](https://en.wikipedia.org/wiki/Printf_format_string) `%010d` to achieve the desired format.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055684_66949713","id":"20210609-190521_549067163","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:32+0000","dateFinished":"2022-01-24T15:47:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65714"},{"title":"Example 3: Converting the student flag from an integer to a Boolean using a Boolean expression","text":"%spark\n\nriders.withColumn(\"student_boolean\", col(\"student\") === 1).select(\"student\", \"student_boolean\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:32+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055689_504417653","id":"20210609-190736_205381703","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:33+0000","dateFinished":"2022-01-24T15:47:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65715"},{"title":"Or using the `cast` method","text":"%spark\n\nriders.withColumn(\"student_boolean\", col(\"student\").cast(\"boolean\")).select(\"student\", \"student_boolean\").show(5)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:34+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055689_-313417482","id":"20210609-190628_1784644919","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:35+0000","dateFinished":"2022-01-24T15:47:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65716"},{"text":"%md\n## Working with string columns","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:36+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055690_-2144803682","id":"20210609-192125_920536293","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:37+0000","dateFinished":"2022-01-24T15:47:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65717"},{"title":"Example 4: Normalizing a string column","text":"%spark\n\n// Use the `trim` and `upper` functions to normalize `riders.sex`:\nimport org.apache.spark.sql.functions.{trim, upper}\n\nriders.withColumn(\"gender\", upper(trim(col(\"sex\")))).select(\"sex\", \"gender\").show(5)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055691_-784949076","id":"20210609-192110_168026378","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:38+0000","dateFinished":"2022-01-24T15:47:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65718"},{"title":"Example 5: Extracting a substring from a string column","text":"%spark\n\nimport org.apache.spark.sql.functions.{substring}\n\nriders.withColumn(\"home_block_group\", substring(col(\"home_block\"), 1, 12)).select(\"home_block\", \"home_block_group\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055691_-1125082223","id":"20210609-192230_933722525","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:40+0000","dateFinished":"2022-01-24T15:47:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65719"},{"title":"Note","text":"%md\nThe [Census Block Group](https://en.wikipedia.org/wiki/Census_block_group) is the first 12 digits of the [Census Block](https://en.wikipedia.org/wiki/Census_block).  Use the `substring` function to extract the Census Block Group from `riders.home_block`.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:41+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055692_-956500182","id":"20210609-192339_312665207","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:42+0000","dateFinished":"2022-01-24T15:47:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65720"},{"title":"Example 6: Extracting a substring using a regular expression","text":"%spark\n\n// Use the `regexp_extract` function to extract the Census Block Group via a regular expression\nimport org.apache.spark.sql.functions.{regexp_extract}\n\nriders.withColumn(\"home_block_group\", regexp_extract($\"home_block\", \"^(\\\\d{12}).*\", 1)).select(\"home_block\", \"home_block_group\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:42+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055693_1435114632","id":"20210609-192628_225892854","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:43+0000","dateFinished":"2022-01-24T15:47:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65721"},{"title":"Note","text":"%md\nThe third argument to `regexp_extract` is the capture group.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:44+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055694_-1329834816","id":"20210609-192547_964098622","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:45+0000","dateFinished":"2022-01-24T15:47:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65722"},{"text":"%md\n## Working with date and timestamp columns","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:45+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055694_-1123553894","id":"20210609-192907_81354757","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:46+0000","dateFinished":"2022-01-24T15:47:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65723"},{"title":"Example 7: Converting a timestamp to a date","text":"%spark\n\n// Note that `riders.birth_date` and `riders.start_date` were read in as timestamps:\nriders.select(\"birth_date\", \"start_date\").show(5)\n\n// Use the `cast` method to convert `riders.birth_date` to a date:\nriders.withColumn(\"birth_date_fixed\", col(\"birth_date\").cast(\"date\")).select(\"birth_date\", \"birth_date_fixed\").show(5)\n\n// Alternatively, use the `to_date` function:\nimport org.apache.spark.sql.functions.{to_date}\n\nriders.withColumn(\"birth_date_fixed\", to_date($\"birth_date\")).select(\"birth_date\", \"birth_date_fixed\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055695_-1392659001","id":"20210609-193157_1228003521","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:47+0000","dateFinished":"2022-01-24T15:47:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65724"},{"title":"Example 8: Converting a string to a timestamp","text":"%spark\n\n// Note that `rides.date_time` was read in as a string:\nrides.printSchema()\n\n// Use the `cast` method to convert it to a timestamp:\nrides.withColumn(\"date_time_fixed\", col(\"date_time\").cast(\"timestamp\")).select(\"date_time\", \"date_time_fixed\").show(5)\n\n// Alternatively, use the `to_timestamp` function:\nimport org.apache.spark.sql.functions.{to_timestamp}\n\nrides.withColumn(\"date_time_fixed\", to_timestamp(col(\"date_time\"), \"yyyy-MM-dd HH:mm\")).select(\"date_time\", \"date_time_fixed\").show(5)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:48+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055696_-21071821","id":"20210609-193255_1861849609","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:49+0000","dateFinished":"2022-01-24T15:47:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65725"},{"title":"Example 9: Computing the age of each rider","text":"%spark\n\n// Use the `current_date` and `months_between` functions to compute the age of each rider:\nimport org.apache.spark.sql.functions.{current_date, months_between, floor}\n\nriders.withColumn(\"today\", current_date()).withColumn(\"age\", floor(months_between($\"today\", $\"birth_date\") / 12)).select(\"birth_date\", \"today\", \"age\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055696_-151942290","id":"20210609-193442_1751573959","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:51+0000","dateFinished":"2022-01-24T15:47:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65726"},{"title":"Note","text":"%md\n\nSpark implicitly casts `birth_date` or `today` as necessary.\nIt is probably safer to explicitly cast one of these columns before computing the number of months between.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:52+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055697_1188272496","id":"20210609-193527_367485667","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:53+0000","dateFinished":"2022-01-24T15:47:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65727"},{"text":"%md\n## Working with Boolean columns","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:53+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055698_2010957163","id":"20210609-193624_1142002341","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:54+0000","dateFinished":"2022-01-24T15:47:54+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65728"},{"title":"Example 10: Predefining a Boolean column expression","text":"%spark\n\n// You can predefine a Boolean column expression:\nval studentFilter = (col(\"student\") === 1)\n\n// You can use the predefined expression to create a new column:\nriders.withColumn(\"student_boolean\", studentFilter).select(\"student\", \"student_boolean\").show(5)\n\n// Or filter a DataFrame:\nriders.filter(studentFilter).select(\"student\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:54+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055699_2082575726","id":"20210609-193653_1080474595","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:55+0000","dateFinished":"2022-01-24T15:47:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65729"},{"title":"Example 11: Working with multiple Boolean column expressions","text":"%spark\n\n// Predefine the Boolean column expressions:\nval studentFilter = col(\"student\") === 1\nval maleFilter = col(\"sex\") === \"male\"\n\n// Create a new column using the AND (`&&`) operator:\nriders.select($\"student\", $\"sex\", studentFilter  && maleFilter).show(15)\n\n// Create a new column using the OR (`||`) operator:\nriders.select($\"student\", $\"sex\", studentFilter || maleFilter).show(15)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055700_-433592218","id":"20210609-193801_200688486","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:57+0000","dateFinished":"2022-01-24T15:47:58+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65730"},{"title":"Important","text":"%md\nThe Boolean column expression parser in Spark SQL is not very advanced. \nUse parentheses liberally in your expressions.\n\nNote the difference in how nulls are treated in the computation:\n* true & null = null\n* false & null = false\n* true | null = true\n* false | null = null","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:47:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055700_583381671","id":"20210609-193908_880262921","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:47:59+0000","dateFinished":"2022-01-24T15:48:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65731"},{"title":"Example 12: Using multiple Boolean expressions in a filter","text":"%spark\n\n// Use `&&` for a logical AND:\nriders.filter(maleFilter && studentFilter).select(\"student\", \"sex\").show(5)\n\n// This is equivalent to\nriders.filter(maleFilter).filter(studentFilter).select(\"student\", \"sex\").show(5)\n\n// Use `||` for a logical OR:\nriders.filter(maleFilter || studentFilter).select(\"student\", \"sex\").show(5)\n\n// Be careful with missing (null) values:\nriders.select(\"sex\").distinct().show()\nriders.filter(col(\"sex\") =!= \"male\").select(\"sex\").distinct().show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055701_1789026282","id":"20210609-194012_1723001284","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:01+0000","dateFinished":"2022-01-24T15:48:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65732"},{"text":"%md\n# Lab\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055703_593312959","id":"20210609-150527_79851234","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:04+0000","dateFinished":"2022-01-24T15:48:04+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65733"},{"title":"1 - Extract the hour of day and day of week from `rides.date_time`","text":"%spark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055704_-363124547","id":"20210609-194218_1866306834","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65734"},{"title":"2 - Convert `rides.duration` from seconds to minutes","text":"%spark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055705_1728296798","id":"20210609-194251_1132019973","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65735"},{"title":"3 - Convert `rides.cancelled` to a Boolean column","text":"%spark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055706_-1443521126","id":"20210609-194317_1768281994","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65736"},{"title":"4 - Create an integer column named `five_star_rating` that is 1.0 if the ride # received a five-star rating and 0.0 otherwise","text":"%spark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:07+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055706_-1049845307","id":"20210609-194402_1894438469","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65737"},{"title":"5 - Create a new column containing the full name for each driver","text":"%spark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055707_1196438479","id":"20210609-194416_623145150","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65738"},{"title":"6 - Create a new column containing the average star rating for each driver","text":"%spark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:09+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055708_403537103","id":"20210609-194542_254158313","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65739"},{"title":"7 - Find the rider names that are most similar to `Brian`","text":"%spark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055709_469358902","id":"20210609-194644_1770059886","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65740"},{"title":"Hint","text":"%md\nUse the [Levenshtein](https://en.wikipedia.org/wiki/Levenshtein_distance) function.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055710_710305318","id":"20210609-194711_921078796","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:12+0000","dateFinished":"2022-01-24T15:48:12+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65741"},{"text":"%md\n# Result\n**You have now:** become familiar with DataFrames columns transformations.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:12+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055711_1978505036","id":"20181119-142716_792318228","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:13+0000","dateFinished":"2022-01-24T15:48:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65742"},{"text":"%md\n# Solution\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055712_105270896","id":"20171113-155535_1769142099","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:14+0000","dateFinished":"2022-01-24T15:48:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65743"},{"title":"1 - Extract the hour of day and day of week from `rides.date_time`","text":"%spark\n\nimport org.apache.spark.sql.functions.{hour, dayofweek}\n\n(rides.withColumn(\"hour_of_day\", hour($\"date_time\"))\n  .withColumn(\"day_of_week\", dayofweek($\"date_time\"))\n  .select(\"date_time\", \"hour_of_day\", \"day_of_week\")\n  .show(5))\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055713_1858154039","id":"20210609-195651_1872389407","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:15+0000","dateFinished":"2022-01-24T15:48:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65744"},{"title":"2 - Convert `rides.duration` from seconds to minutes","text":"%spark\n\nimport org.apache.spark.sql.functions.{col, round}\n\n(rides \n  .withColumn(\"duration_in_minutes\", round(col(\"duration\") / 60, 1))\n  .select(\"duration\", \"duration_in_minutes\")\n  .show(5))","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055714_994347471","id":"20210609-195642_138712395","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:17+0000","dateFinished":"2022-01-24T15:48:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65745"},{"title":"3 - Convert `rides.cancelled` to a Boolean column","text":"%spark\n\n// Using the `cast` method:\n\nrides.withColumn(\"cancelled\", col(\"cancelled\").cast(\"boolean\")).select(\"cancelled\").show(5)\n\n// Using a Boolean expression:\nrides.withColumn(\"cancelled\", col(\"cancelled\") === 1).select(\"cancelled\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055715_-1215293930","id":"20210609-195631_1606468230","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:19+0000","dateFinished":"2022-01-24T15:48:20+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65746"},{"title":"4 - Create an integer column named `five_star_rating` that is 1.0 if the ride # received a five-star rating and 0.0 otherwise","text":"%spark\n\n// Using a Boolean expression and the `cast` method:\n\nrides.withColumn(\"five_star_rating\", (col(\"star_rating\") > 4.5).cast(\"double\")).select(\"star_rating\", \"five_star_rating\").show(10)\n  \n// Using the `when` function and the `when` and `otherwise` methods:\nimport org.apache.spark.sql.functions.{when}\n\n(rides\n  .withColumn(\"five_star_rating\", when(col(\"star_rating\").isNull, null).when(col(\"star_rating\") === 5, 1.0).otherwise(0.0))\n  .select(\"star_rating\", \"five_star_rating\")\n  .show(10))","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":170.69293212890625,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055716_-781930847","id":"20210609-195622_1467277551","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:22+0000","dateFinished":"2022-01-24T15:48:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65747"},{"title":"Note","text":"%md\nBeware of null values when generating new columns.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:23+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055717_-701148528","id":"20210609-195920_987897921","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:24+0000","dateFinished":"2022-01-24T15:48:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65748"},{"title":"5 - Create a new column containing the full name for each driver","text":"%spark\n\nimport org.apache.spark.sql.functions.{concat_ws}\n\ndrivers.withColumn(\"full_name\", concat_ws(\" \",$\"first_name\", $\"last_name\")).select(\"first_name\", \"last_name\", \"full_name\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:24+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055718_-919419814","id":"20210609-195614_1724452243","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:25+0000","dateFinished":"2022-01-24T15:48:26+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65749"},{"title":"6 - Create a new column containing the average star rating for each driver","text":"%spark\n\ndrivers.withColumn(\"star_rating\", round(col(\"stars\") / col(\"rides\"), 2)).select(\"rides\", \"stars\", \"star_rating\").show(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055719_1851169224","id":"20210609-195557_1315209045","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:27+0000","dateFinished":"2022-01-24T15:48:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65750"},{"title":"7 - Find the rider names that are most similar to `Brian`","text":"%spark\n\nimport org.apache.spark.sql.functions.{lit, levenshtein}\n\n(riders\n  .select(\"first_name\") \n  .distinct()\n  .withColumn(\"distance\", levenshtein(col(\"first_name\"), lit(\"Brian\")))\n  .sort(\"distance\")\n  .show())","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:28+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055720_1217494467","id":"20210609-195550_702601164","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:29+0000","dateFinished":"2022-01-24T15:48:30+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65751"},{"title":"References","text":"%md\n* [Spark Python API - pyspark.sql.types module](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html#data-types)\n\n* [Spark Python API - pyspark.sql.DataFrame class](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html#dataframe-apis)\n\n* [Spark Python API - pyspark.sql.Column class](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html#column-apis)\n\n* [Spark Python API - pyspark.sql.functions module](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html#functions)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055722_56629138","id":"20210609-194931_920207158","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:31+0000","dateFinished":"2022-01-24T15:48:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65752"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055723_-672258614","id":"20181116-135131_93712280","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:31+0000","dateFinished":"2022-01-24T15:48:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65753"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:32+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055724_411367481","id":"20200110-154537_1406191376","dateCreated":"2022-01-24T15:44:15+0000","dateStarted":"2022-01-24T15:48:32+0000","dateFinished":"2022-01-24T15:48:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65754"},{"text":"%angular\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:48:33+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039055725_-939205752","id":"20200110-162013_302547143","dateCreated":"2022-01-24T15:44:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65755"}],"name":"DE/Labs/Scala/WorkingWithColumns","id":"2GTX86T4X","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}