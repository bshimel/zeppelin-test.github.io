{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Become familiar with Spark complex types operations\n**File locations:** s3://shared-edu/sci/\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Working with DataFrames\n\nCopyright © 2010–2021 Cloudera. All rights reserved.\nNot to be reproduced or shared without prior written consent from Cloudera.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:57:59+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555337_-1708741726","id":"20171105-200834_1116095891","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:12+0000","dateFinished":"2022-01-24T15:55:12+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:69565"},{"text":"%md\n## Overview\n\nIn this module we consider the complex collection data types provided bySpark SQL: arrays, maps, and structs.\nWe show how to construct and transform columns with complex collection data types.\n\n\n## Complex Collection Data Types\n\n* Complex collection data types provide a way to renormalize the denormalized data that is common in the big-data world\n\n* The complex collection data types are defined in the `pyspark.sql.types` module:\n    * The *ArrayType* represents a variable-length collection of elements\n    * The *MapType* represents a variable-length collection of key-value pairs\n    * The *StructType* represents a fixed-length collection of named elements\n\n* Complex collection data types are obtained in several ways:\n    * Inherited from Hive/Impala tables\n    * Inferred from nested JSON files\n    * Generated by aggregate functions such as `collect_list` and `collect_set`\n    * Constructed manually","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:12+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555338_1184092965","id":"20210609-214236_1622006817","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:13+0000","dateFinished":"2022-01-24T15:55:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69566"},{"text":"%md\n# Setup\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555338_1494113246","id":"20181114-164229_902436001","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:14+0000","dateFinished":"2022-01-24T15:55:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69567"},{"title":"Required for Kerberos operations","text":"%sh\n\necho $PASS | kinit $USER","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:59:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039644885_389100068","id":"20220124-155404_1870990609","dateCreated":"2022-01-24T15:54:04+0000","dateStarted":"2022-01-24T15:55:15+0000","dateFinished":"2022-01-24T15:55:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69568"},{"title":"Setup the data context","text":"%sh\n\nrm -rf data\nmkdir -p data\naws s3 cp --recursive s3://shared-edu/sci/duocar/raw data/raw\nhdfs dfs -mkdir -p duocar\nhdfs dfs -put -f data duocar","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:59:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039668089_-2009265786","id":"20220124-155428_1270357309","dateCreated":"2022-01-24T15:54:28+0000","dateStarted":"2022-01-24T15:55:15+0000","dateFinished":"2022-01-24T15:55:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69569"},{"title":"Read the raw data from HDFS","text":"%pyspark\n\nrides = spark.read.csv(\"duocar/raw/rides/\", header=True, inferSchema=True)\ndrivers = spark.read.csv(\"duocar/raw/drivers/\", header=True, inferSchema=True)\nriders = spark.read.csv(\"duocar/raw/riders/\", header=True, inferSchema=True)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555339_-801974175","id":"20210609-214604_1208392134","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:25+0000","dateFinished":"2022-01-24T15:55:26+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69570"},{"text":"%md\n# Lesson\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:26+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555339_-950702657","id":"20210609-150445_381117564","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:27+0000","dateFinished":"2022-01-24T15:55:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69571"},{"text":"%md\n## Arrays","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:28+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555340_-1229259507","id":"20210609-214808_2124581014","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:28+0000","dateFinished":"2022-01-24T15:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69572"},{"title":"Use the array function to create an array from multiple columns","text":"%pyspark\n\nfrom pyspark.sql.functions import array\ndrivers_array = drivers \\\n  .withColumn(\"vehicle_array\", array(\"vehicle_make\", \"vehicle_model\")) \\\n  .select(\"vehicle_make\", \"vehicle_model\", \"vehicle_array\")\ndrivers_array.printSchema()\ndrivers_array.show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:28+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555340_1410327180","id":"20210609-214950_490436151","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:29+0000","dateFinished":"2022-01-24T15:55:30+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69573"},{"title":"Use index notation to access elements of the array","text":"%pyspark\n\nfrom pyspark.sql.functions import col\ndrivers_array \\\n  .select(\"vehicle_array\", col(\"vehicle_array\")[0]) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:30+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555340_-1158337332","id":"20210609-215139_462878767","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:31+0000","dateFinished":"2022-01-24T15:55:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69574"},{"title":"Use the size function to get the length of the array","text":"%pyspark\n\nfrom pyspark.sql.functions import size\ndrivers_array \\\n  .select(\"vehicle_array\", size(\"vehicle_array\")) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:32+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555341_-188259254","id":"20210609-215230_879633660","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:33+0000","dateFinished":"2022-01-24T15:55:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69575"},{"title":"Use the sort_array function to sort the array","text":"%pyspark\n\nfrom pyspark.sql.functions import sort_array\ndrivers_array \\\n  .select(\"vehicle_array\", sort_array(\"vehicle_array\", asc=True)) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:34+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555341_-134260789","id":"20210609-215326_1600236400","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:35+0000","dateFinished":"2022-01-24T15:55:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69576"},{"title":"Use the `array_contains` function to search the array","text":"%pyspark\n\nfrom pyspark.sql.functions import array_contains\ndrivers_array \\\n  .select(\"vehicle_array\", array_contains(\"vehicle_array\", \"Subaru\")) \\\n  .show(5, False)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:36+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555341_1167175588","id":"20210609-215508_1658632882","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:38+0000","dateFinished":"2022-01-24T15:55:39+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69577"},{"title":"Use the `explode` and `posexplode` functions to explode the array","text":"%pyspark\n\nfrom pyspark.sql.functions import explode, posexplode\ndrivers_array \\\n  .select(\"vehicle_array\", explode(\"vehicle_array\")) \\\n  .show(5, False)\ndrivers_array \\\n  .select(\"vehicle_array\", posexplode(\"vehicle_array\")) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:39+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555342_-1511182478","id":"20210609-215631_592611552","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:42+0000","dateFinished":"2022-01-24T15:55:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69578"},{"title":"Note that you can pass multiple names to the `alias` method","text":"%pyspark\n\ndrivers_array \\\n  .select(\"vehicle_array\", posexplode(\"vehicle_array\").alias(\"position\", \"column\")) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:43+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555342_-18097553","id":"20210609-215708_1101979237","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:44+0000","dateFinished":"2022-01-24T15:55:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69579"},{"text":"%md\n## Maps","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:45+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555343_207132452","id":"20210609-214825_941697596","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:46+0000","dateFinished":"2022-01-24T15:55:46+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69580"},{"title":"Use the create_map function to create a map","text":"%pyspark\n\nfrom pyspark.sql.functions import lit, create_map\ndrivers_map = drivers \\\n  .withColumn(\"vehicle_map\", create_map(lit(\"make\"), \"vehicle_make\", lit(\"model\"), \"vehicle_model\")) \\\n  .select(\"vehicle_make\", \"vehicle_model\", \"vehicle_map\")\ndrivers_map.printSchema()\ndrivers_map.show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:46+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555343_-594873721","id":"20210609-215809_1949067261","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:46+0000","dateFinished":"2022-01-24T15:55:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69581"},{"title":"Use dot notation to access a value by key","text":"%pyspark\n\ndrivers_map.select(\"vehicle_map\", col(\"vehicle_map\").make).show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:48+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555343_-1493382630","id":"20210609-215929_1972517761","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:48+0000","dateFinished":"2022-01-24T15:55:49+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69582"},{"title":"Use the `size` function to get the length of the map","text":"%pyspark\n\ndrivers_map.select(\"vehicle_map\", size(\"vehicle_map\")).show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555344_157156431","id":"20210609-220011_2145852577","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:51+0000","dateFinished":"2022-01-24T15:55:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69583"},{"title":"Use the `explode` and `posexplode` functions to explode the map","text":"%pyspark\n\ndrivers_map.select(\"vehicle_map\", explode(\"vehicle_map\")).show(5, False)\ndrivers_map.select(\"vehicle_map\", posexplode(\"vehicle_map\")).show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:52+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555344_-1025806354","id":"20210609-220050_526377266","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:52+0000","dateFinished":"2022-01-24T15:55:53+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69584"},{"text":"%md\n## Structs","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:54+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555345_-1929913045","id":"20210609-214847_1367988366","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:54+0000","dateFinished":"2022-01-24T15:55:54+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69585"},{"title":"Use the struct function to create a struct","text":"%pyspark\n\nfrom pyspark.sql.functions import struct\ndrivers_struct = drivers \\\n  .withColumn(\"vehicle_struct\", struct(col(\"vehicle_make\").alias(\"make\"), col(\"vehicle_model\").alias(\"model\"))) \\\n  .select(\"vehicle_make\", \"vehicle_model\", \"vehicle_struct\")\ndrivers_struct.printSchema()\ndrivers_struct.show(5, False)\ndrivers_struct.head(5)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555345_734917297","id":"20210609-220250_300408590","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:55+0000","dateFinished":"2022-01-24T15:55:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69586"},{"title":"Note","text":"%md\nThe struct is a `Row` object (embedded in a `Row` object).","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:56+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555345_1386074185","id":"20210609-220428_2046707505","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:57+0000","dateFinished":"2022-01-24T15:55:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69587"},{"title":"Use dot notation to access struct elements","text":"%pyspark\n\ndrivers_struct \\\n  .select(\"vehicle_struct\", col(\"vehicle_struct\").make) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:58+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555346_459244100","id":"20210609-220408_1212114924","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:55:58+0000","dateFinished":"2022-01-24T15:55:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69588"},{"title":"Use the `to_json` function to convert the struct to a JSON string","text":"%pyspark\n\nfrom pyspark.sql.functions import to_json\ndrivers_struct \\\n  .select(\"vehicle_struct\", to_json(\"vehicle_struct\")) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:55:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555346_-2051829423","id":"20210609-220533_1798862611","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:00+0000","dateFinished":"2022-01-24T15:56:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69589"},{"text":"%md\n# Lab\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555347_-1341581106","id":"20210609-150527_79851234","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:03+0000","dateFinished":"2022-01-24T15:56:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69590"},{"title":"1 - Create an array called `home_array` that includes the driver's home latitude and longitude","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555348_651325742","id":"20210609-221114_987659308","dateCreated":"2022-01-24T15:52:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69591"},{"title":"2 - Create a map called `name_map` that includes the driver's first and last name","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555348_-719268717","id":"20210609-221146_1508826613","dateCreated":"2022-01-24T15:52:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69592"},{"title":"3 - Create a struct called `name_struct` that includes the driver's first # and last name","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:05+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555349_213669193","id":"20210609-221144_10985682","dateCreated":"2022-01-24T15:52:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69593"},{"text":"%md\n# Result\n**You have now:** become familiar with Spark complex types operations\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:06+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555349_-1200363163","id":"20181119-142716_792318228","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:07+0000","dateFinished":"2022-01-24T15:56:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69594"},{"text":"%md\n# Solution\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:07+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555350_934357589","id":"20171113-155535_1769142099","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:07+0000","dateFinished":"2022-01-24T15:56:07+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69595"},{"title":"1 - Create an array called `home_array` that includes the driver's home latitude and longitude","text":"%pyspark\n\nfrom pyspark.sql.functions import array\n\ndrivers_array = drivers \\\n  .withColumn(\"home_array\", array(\"home_lat\", \"home_lon\"))\n\ndrivers_array \\\n  .select(\"home_lat\", \"home_lon\", \"home_array\") \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:08+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555351_237014677","id":"20210609-221342_1618027877","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:08+0000","dateFinished":"2022-01-24T15:56:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69596"},{"title":"2 - Create a map called `name_map` that includes the driver's first and last name","text":"%pyspark\n\nfrom pyspark.sql.functions import lit, create_map\n\ndrivers_map = drivers \\\n  .withColumn(\"name_map\", create_map(lit(\"first\"), \"first_name\", lit(\"last\"), \"last_name\"))\n  \ndrivers_map \\\n  .select(\"first_name\", \"last_name\", \"name_map\") \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:10+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555351_-1913528283","id":"20210609-221423_1874248249","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:10+0000","dateFinished":"2022-01-24T15:56:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69597"},{"title":"3 - Create a struct called `name_struct` that includes the driver's first # and last name","text":"%pyspark\n\nfrom pyspark.sql.functions import col, struct\ndrivers_struct = drivers \\\n  .withColumn(\"name_struct\", struct(col(\"first_name\").alias(\"first\"), col(\"last_name\").alias(\"last\")))\n\nfrom pyspark.sql.functions import to_json\ndrivers_struct \\\n  .select(\"first_name\", \"last_name\", \"name_struct\", to_json(\"name_struct\")) \\\n  .show(5, False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555352_-1809279530","id":"20210609-221431_532662891","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:12+0000","dateFinished":"2022-01-24T15:56:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69598"},{"title":"References","text":"%md\n\n* [Spark Python API - pyspark.sql.functions.array](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.types.ArrayType.html#pyspark.sql.types.ArrayType)\n\n* [Spark Python API - pyspark.sql.functions.create_map](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.types.MapType.html#pyspark.sql.types.MapType)\n\n* [Spark Python API - pyspark.sql.functions.struct](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.types.StructType.html#pyspark.sql.types.StructType)\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:13+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555354_-1913965327","id":"20210609-220720_2066698488","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:14+0000","dateFinished":"2022-01-24T15:56:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69599"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:14+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555354_-376464260","id":"20181116-135131_93712280","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:15+0000","dateFinished":"2022-01-24T15:56:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69600"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:15+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555355_-904214292","id":"20200110-154537_1406191376","dateCreated":"2022-01-24T15:52:35+0000","dateStarted":"2022-01-24T15:56:16+0000","dateFinished":"2022-01-24T15:56:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69601"},{"text":"%angular\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-24T15:56:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643039555356_-1108583298","id":"20200110-162013_302547143","dateCreated":"2022-01-24T15:52:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69602"}],"name":"DE/Labs/Pyspark/WorkingWithComplexTypes","id":"2GT48JBDB","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}