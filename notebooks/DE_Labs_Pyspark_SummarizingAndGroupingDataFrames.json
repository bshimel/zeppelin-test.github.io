{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Become familiar with grouping and aggregating transformations\n**File locations:** s3://shared-edu/sci/\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Working with DataFrames\n\nCopyright © 2010–2021 Cloudera. All rights reserved.\nNot to be reproduced or shared without prior written consent from Cloudera.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:22:18+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328479_-126877144","id":"20171105-200834_1116095891","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:16:58+0000","dateFinished":"2022-01-25T13:17:00+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25723"},{"text":"%md\n## Overview\n\nIn this module we demonstrate how to summarize, group, and pivot data in a DataFrame.\n\n* Summarizing data with aggregate functions\n* Grouping data\n* Pivoting data","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:17:00+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328480_1200708733","id":"20210610-000856_746579081","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:17:01+0000","dateFinished":"2022-01-25T13:17:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25724"},{"text":"%md\n# Setup\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:17:01+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328480_2035897875","id":"20181114-164229_902436001","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:17:02+0000","dateFinished":"2022-01-25T13:17:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25725"},{"title":"Required for Kerberos operations","text":"%sh\n\necho $PASS | kinit $USER","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:27:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115515447_1152760898","id":"20220125-125835_391321592","dateCreated":"2022-01-25T12:58:35+0000","dateStarted":"2022-01-25T13:17:03+0000","dateFinished":"2022-01-25T13:17:05+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25726"},{"title":"Setup the data context","text":"%sh\n\nrm -rf data\nmkdir -p data\naws s3 cp --recursive s3://shared-edu/sci/duocar/joined data/joined\nhdfs dfs -rm -r duocar\nhdfs dfs -mkdir -p duocar\nhdfs dfs -put -f data duocar","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:27:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115689100_-975667840","id":"20220125-130129_853737047","dateCreated":"2022-01-25T13:01:29+0000","dateStarted":"2022-01-25T13:17:06+0000","dateFinished":"2022-01-25T13:17:14+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25727"},{"title":"Read and persist the joined data","text":"%pyspark\n\n# Read the enhanced (joined) ride data from HDFS:\nrides = spark.read.parquet(\"duocar/data/joined/\")\n\n# Since we will be querying the `rides` DataFrame many times, let us persist it in memory to improve performance:\nrides.persist()\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:17:14+0000","config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328480_1108831463","id":"20210610-001349_2084269529","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:17:15+0000","dateFinished":"2022-01-25T13:17:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25728"},{"text":"%md\n# Lesson\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:17:56+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328481_-401272207","id":"20210609-150445_381117564","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:17:56+0000","dateFinished":"2022-01-25T13:17:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25729"},{"text":"%md\n## Summarizing data with aggregate functions\n\nSpark provides a number of summarization (aggregate) functions.  ","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:17:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328481_22648336","id":"20210610-001508_600148588","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:17:57+0000","dateFinished":"2022-01-25T13:17:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25730"},{"title":"For example, the `describe` method provides basic summary statistics","text":"%pyspark\n\nrides.describe(\"distance\").show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:17:57+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328482_-1573660552","id":"20210610-001608_697670181","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:17:58+0000","dateFinished":"2022-01-25T13:18:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25731"},{"title":"Use the `count`, `countDistinct`, and `approx_count_distinct` functions to compute various column counts","text":"%pyspark\n\nfrom pyspark.sql.functions import count, countDistinct, approx_count_distinct\nrides.select(count(\"*\"), count(\"distance\"), countDistinct(\"distance\"), approx_count_distinct(\"distance\")).show()\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328482_1654617486","id":"20210610-001750_2040367422","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:04+0000","dateFinished":"2022-01-25T13:18:10+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25732"},{"title":"Note","text":"%md\nThe `count` function returns the number of rows with non-null values.\nUse `count(lit(1))` rather than `count(1)` as an alternative to `count(\"*\")`.","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:10+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328483_1753132136","id":"20210610-001844_1194688367","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:11+0000","dateFinished":"2022-01-25T13:18:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25733"},{"title":"The `agg` method returns the same results and can be applied to grouped data","text":"%pyspark\n\nrides.agg(count(\"*\"), count(\"distance\"), countDistinct(\"distance\"), approx_count_distinct(\"distance\")).show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:11+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328483_-1999067861","id":"20210610-002029_229017827","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:12+0000","dateFinished":"2022-01-25T13:18:15+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25734"},{"title":"Use the `sum` and `sumDistinct` functions to compute various column sums","text":"%pyspark\n\nfrom pyspark.sql.functions import sum, sumDistinct\nrides.agg(sum(\"distance\"), sumDistinct(\"distance\")).show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328484_672153670","id":"20210610-002159_105666656","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:16+0000","dateFinished":"2022-01-25T13:18:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25735"},{"title":"Note","text":"%md\nWhen would one use the `sumDistinct` function?","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:18+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328484_-1194123732","id":"20210610-002251_287057366","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:19+0000","dateFinished":"2022-01-25T13:18:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25736"},{"title":"Spark SQL provides a number of summary statistics","text":"%pyspark\n\nfrom pyspark.sql.functions import mean, stddev, variance, skewness, kurtosis\nrides.agg(mean(\"distance\"), stddev(\"distance\"), variance(\"distance\"), skewness(\"distance\"), kurtosis(\"distance\")).show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:19+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328485_-1471570079","id":"20210610-002353_144721134","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:19+0000","dateFinished":"2022-01-25T13:18:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25737"},{"title":"Note","text":"%md\n`mean` is an alias for `avg`, `stddev` is an alias for the sample standard deviation `stddev_samp`, and `variance` is an alias for the sample variance `var_samp`.  \nThe population standard deviation and population variance are available via `stddev_pop` and `var_pop`, respectively.","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:21+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328485_-1281241491","id":"20210610-002536_624409551","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:21+0000","dateFinished":"2022-01-25T13:18:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25738"},{"title":"Use the `min` and `max` functions to compute the minimum and maximum, respectively","text":"%pyspark\n\nfrom pyspark.sql.functions import min, max\nrides.agg(min(\"distance\"), max(\"distance\")).show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:21+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328486_-1291289485","id":"20210610-004653_1846994497","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:22+0000","dateFinished":"2022-01-25T13:18:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25739"},{"title":"Use the `first` and `last` functions to compute the first and last values, respectively","text":"%pyspark\n\nfrom pyspark.sql.functions import first, last\nrides \\\n  .orderBy(\"distance\") \\\n  .agg(first(\"distance\", ignorenulls=False), last(\"distance\", ignorenulls=False)) \\\n  .show()\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:23+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328486_-2077721747","id":"20210610-004917_1946337516","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:24+0000","dateFinished":"2022-01-25T13:18:26+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25740"},{"title":"Note","text":"%md\nNull values sort before valid numerical values.","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:26+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328487_574139237","id":"20210610-005028_192865414","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:27+0000","dateFinished":"2022-01-25T13:18:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25741"},{"title":"Use the `corr`, `covar_samp`, or `covar_pop` functions to measure the linear association between two columns","text":"%pyspark\n\nfrom pyspark.sql.functions import corr, covar_samp, covar_pop\nrides \\\n  .agg(corr(\"distance\", \"duration\"), covar_samp(\"distance\", \"duration\"), covar_pop(\"distance\", \"duration\")) \\\n  .show()\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328487_538670543","id":"20210610-005108_1053279348","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:28+0000","dateFinished":"2022-01-25T13:18:29+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25742"},{"title":"The `collect_list` and `collect_set` functions return a column of array type","text":"%pyspark\n\nfrom pyspark.sql.functions import collect_list, collect_set\nrides.agg(collect_set(\"service\")).show(truncate=False)","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:29+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328488_439285045","id":"20210610-005214_1158162099","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:30+0000","dateFinished":"2022-01-25T13:18:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25743"},{"title":"Note","text":"%md\n`collect_list` does not remove duplicates and will return a very long array in this case.","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328488_99590308","id":"20210610-005311_924230397","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:31+0000","dateFinished":"2022-01-25T13:18:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25744"},{"text":"%md\n## Grouping data","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328489_-321666760","id":"20210610-005406_1475956556","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:32+0000","dateFinished":"2022-01-25T13:18:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25745"},{"title":"Use the `agg` method with the `groupBy` (or `groupby`) method to refine your analysis","text":"%pyspark\n\nrides \\\n  .groupBy(\"rider_student\") \\\n  .agg(count(\"*\"), count(\"distance\"), mean(\"distance\"), stddev(\"distance\")) \\\n  .show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328489_1705585929","id":"20210610-005459_562960104","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:33+0000","dateFinished":"2022-01-25T13:18:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25746"},{"title":"You can use more than one column in the `groupBy` method","text":"%pyspark\n\nrides \\\n  .groupBy(\"rider_student\", \"service\") \\\n  .agg(count(\"*\"), count(\"distance\"), mean(\"distance\"), stddev(\"distance\")) \\\n  .orderBy(\"rider_student\", \"service\") \\\n  .show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:35+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328490_1841550154","id":"20210610-005507_72302918","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:36+0000","dateFinished":"2022-01-25T13:18:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25747"},{"title":"Use the `rollup` method to get some subtotals","text":"%pyspark\n\nrides \\\n  .rollup(\"rider_student\", \"service\") \\\n  .agg(count(\"*\"), count(\"distance\"), mean(\"distance\"), stddev(\"distance\")) \\\n  .orderBy(\"rider_student\", \"service\") \\\n  .show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:38+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328490_-322583635","id":"20210610-005622_943449604","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:39+0000","dateFinished":"2022-01-25T13:18:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25748"},{"title":" Use the `grouping` function to identify grouped rows","text":"%pyspark\n\nfrom pyspark.sql.functions import grouping\nrides \\\n  .rollup(\"rider_student\", \"service\") \\\n  .agg(grouping(\"rider_student\"), grouping(\"service\"), count(\"*\"), count(\"distance\"), mean(\"distance\"), stddev(\"distance\")) \\\n  .orderBy(\"rider_student\", \"service\") \\\n  .show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:41+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328491_1626815183","id":"20210610-005654_256119548","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:42+0000","dateFinished":"2022-01-25T13:18:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25749"},{"title":"Use the `cube` method to get all subtotals","text":"%pyspark\n\nrides \\\n  .cube(\"rider_student\", \"service\") \\\n  .agg(count(\"*\"), count(\"distance\"), mean(\"distance\"), stddev(\"distance\")) \\\n  .orderBy(\"rider_student\", \"service\") \\\n  .show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:44+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328491_668543540","id":"20210610-005725_963905302","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:45+0000","dateFinished":"2022-01-25T13:18:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25750"},{"title":"Use the `grouping_id` function to identify grouped rows","text":"%pyspark\n\nfrom pyspark.sql.functions import grouping_id\nrides \\\n  .cube(\"rider_student\", \"service\") \\\n  .agg(grouping_id(\"rider_student\", \"service\"), count(\"*\"), count(\"distance\"), mean(\"distance\"), stddev(\"distance\")) \\\n  .orderBy(\"rider_student\", \"service\") \\\n  .show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:48+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328492_138839226","id":"20210610-005451_1732153318","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:48+0000","dateFinished":"2022-01-25T13:18:51+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25751"},{"text":"%md\n## Pivoting data","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328492_481419911","id":"20210610-005420_612603285","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:52+0000","dateFinished":"2022-01-25T13:18:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25752"},{"title":"The following use case is common","text":"%pyspark\n\nrides.groupBy(\"rider_student\", \"service\").count().orderBy(\"rider_student\", \"service\").show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:52+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328493_-880882943","id":"20210610-005933_221072209","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:53+0000","dateFinished":"2022-01-25T13:18:54+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25753"},{"title":"The `crosstab` method can be used to present this result in a pivot table","text":"%pyspark\n\nrides.crosstab(\"rider_student\", \"service\").show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328493_-321583753","id":"20210610-010020_786598568","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:54+0000","dateFinished":"2022-01-25T13:18:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25754"},{"title":"We can also use the `pivot` method to produce a cross-tabulation","text":"%pyspark\n\nrides.groupBy(\"rider_student\").pivot(\"service\").count().show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:56+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328494_1729492620","id":"20210610-010054_1613521590","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:18:56+0000","dateFinished":"2022-01-25T13:18:59+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25755"},{"title":" We can also perform other aggregations","text":"%pyspark\n\nrides.groupBy(\"rider_student\").pivot(\"service\").mean(\"distance\").show()\nrides.groupBy(\"rider_student\").pivot(\"service\").agg(mean(\"distance\")).show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:18:59+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328494_1463106886","id":"20210610-010132_1478700646","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:00+0000","dateFinished":"2022-01-25T13:19:04+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25756"},{"title":"You can explicitly choose the values that are pivoted to columns","text":"%pyspark\n\nrides.groupBy(\"rider_student\").pivot(\"service\", [\"Car\", \"Grand\"]).agg(mean(\"distance\")).show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:04+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328495_1649341252","id":"20210610-010326_792064606","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:06+0000","dateFinished":"2022-01-25T13:19:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25757"},{"title":"Additional aggregation functions produce additional columns","text":"%pyspark\n\nrides.groupBy(\"rider_student\").pivot(\"service\", [\"Car\"]).agg(count(\"distance\"), mean(\"distance\")).show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:08+0000","config":{"tableHide":false,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328495_1318164121","id":"20210610-005930_840992557","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:09+0000","dateFinished":"2022-01-25T13:19:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25758"},{"text":"%md\n# Lab\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:11+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328496_-603658601","id":"20210609-150527_79851234","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:12+0000","dateFinished":"2022-01-25T13:19:12+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25759"},{"title":"1 - Who are DuoCar's top 10 riders in terms of number of rides taken?","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:12+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328496_-1330654204","id":"20210610-011625_1452114877","dateCreated":"2022-01-25T12:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25760"},{"title":"2 - Who are DuoCar's top 10 drivers in terms of total distance driven?","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:13+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328497_556584771","id":"20210610-011614_1512222076","dateCreated":"2022-01-25T12:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25761"},{"title":"3 - Compute the distribution of cancelled rides","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328497_258794312","id":"20210610-011606_391730360","dateCreated":"2022-01-25T12:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25762"},{"title":"4 - Compute the distribution of ride star rating. When is the ride star rating missing?","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:15+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328498_-296798366","id":"20210610-011552_1782016420","dateCreated":"2022-01-25T12:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25763"},{"title":"5 - Compute the average star rating for each level of car service. Is the star rating correlated with the level of car service?","text":"%pyspark\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:16+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328498_989770865","id":"20210610-011545_1946555160","dateCreated":"2022-01-25T12:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25764"},{"text":"%md\n# Result\n**You have now:** become familiar with grouping and aggregating transformations.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:17+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328499_2018611369","id":"20181119-142716_792318228","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:17+0000","dateFinished":"2022-01-25T13:19:17+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25765"},{"text":"%md\n# Solution\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:17+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328499_-1414279579","id":"20171113-155535_1769142099","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:18+0000","dateFinished":"2022-01-25T13:19:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25766"},{"title":"1 - Who are DuoCar's top 10 riders in terms of number of rides taken?","text":"%pyspark\n\nfrom pyspark.sql.functions import col\nrides \\\n  .filter(col(\"cancelled\") == False) \\\n  .groupBy(\"rider_id\") \\\n  .count() \\\n  .orderBy(col(\"count\").desc()) \\\n  .show(10)","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:18+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328500_941019792","id":"20210610-011139_1670043913","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:19+0000","dateFinished":"2022-01-25T13:19:20+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25767"},{"title":"2 - Who are DuoCar's top 10 drivers in terms of total distance driven?","text":"%pyspark\n\nfrom pyspark.sql.functions import sum\nrides \\\n  .groupBy(\"driver_id\") \\\n  .agg(sum(\"distance\").alias(\"sum_distance\")) \\\n  .orderBy(col(\"sum_distance\").desc()) \\\n  .show(10)","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:20+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328500_1682395621","id":"20210610-011211_2135462098","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:21+0000","dateFinished":"2022-01-25T13:19:22+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25768"},{"title":"3 - Compute the distribution of cancelled rides","text":"%pyspark\n\nrides.groupBy(\"cancelled\").count().show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:22+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328501_1895912782","id":"20210610-011139_878946709","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:23+0000","dateFinished":"2022-01-25T13:19:24+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25769"},{"title":"4 - Compute the distribution of ride star rating. When is the ride star rating missing?","text":"%pyspark\n\nrides.groupBy(\"star_rating\").count().orderBy(\"star_rating\").show()\n\n# The star rating is missing when a ride is cancelled:\nrides.crosstab(\"star_rating\", \"cancelled\").orderBy(\"star_rating_cancelled\").show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:24+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328501_569749162","id":"20210610-011303_224520349","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:25+0000","dateFinished":"2022-01-25T13:19:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25770"},{"title":"5 - Compute the average star rating for each level of car service. Is the star rating correlated with the level of car service?","text":"%pyspark\n\nrides.groupBy(\"service\").mean(\"star_rating\").show()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:27+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328502_1673977896","id":"20210610-011331_93208156","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:27+0000","dateFinished":"2022-01-25T13:19:29+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25771"},{"text":"%md\n# Tear Down\n---","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:29+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328502_655383376","id":"20210609-150643_1464999975","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:29+0000","dateFinished":"2022-01-25T13:19:30+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25772"},{"title":"Unpersist the DataFrame","text":"%pyspark\n\nrides.unpersist()","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:30+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328503_-1343340339","id":"20210610-010456_50543468","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:30+0000","dateFinished":"2022-01-25T13:19:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25773"},{"title":"References","text":"%md\n* [Spark Python API - pyspark.sql.functions module](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql.html#functions)\n\n* [Spark Python API - pyspark.sql.GroupedData class](https://spark.apache.org/docs/latest/api/python/reference/api/pyspark.sql.GroupedData.html#pyspark.sql.GroupedData)\n\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328504_12391386","id":"20210610-010615_792876973","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:32+0000","dateFinished":"2022-01-25T13:19:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25774"},{"text":"%sh\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:32+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328504_1104529496","id":"20210610-010615_1106547937","dateCreated":"2022-01-25T12:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25775"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328505_2059605095","id":"20181116-135131_93712280","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:48+0000","dateFinished":"2022-01-25T13:19:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25776"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:48+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328505_-1926500219","id":"20200110-154537_1406191376","dateCreated":"2022-01-25T12:55:28+0000","dateStarted":"2022-01-25T13:19:49+0000","dateFinished":"2022-01-25T13:19:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25777"},{"text":"%angular\n","user":"freynalddeveuwest1","dateUpdated":"2022-01-25T13:19:51+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1643115328505_-1145034797","id":"20200110-162013_302547143","dateCreated":"2022-01-25T12:55:28+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25778"}],"name":"DE/Labs/Pyspark/SummarizingAndGroupingDataFrames","id":"2GSC26138","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}