{"paragraphs":[{"text":"%md\n# About This Lab\n**Objective:** Become familiar with Spark operations using Hive\n**File locations:**\n**Successful outcome:**\n**Before you begin:**\n**Related lessons:** Spark Integration with Hive\n\nCopyright © 2010–2021 Cloudera. All rights reserved.\nNot to be reproduced or shared without prior written consent from Cloudera.\n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:00:44+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758381_163975134","id":"20171105-200834_1116095891","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:00:44+0000","dateFinished":"2022-03-24T13:00:45+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:25729"},{"text":"%md\n# Setup\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:00:56+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758389_1480182071","id":"20181114-164229_902436001","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:00:56+0000","dateFinished":"2022-03-24T13:00:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25730"},{"title":"Required for Kerberos operations","text":"%sh\n\necho $PASS | kinit $USER","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:04:34+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758390_1189231925","id":"20210610-153633_877016790","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:04:30+0000","dateFinished":"2022-03-24T13:04:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25731"},{"title":"Clean Database and HDFS Folders","text":"%jdbc(hive)\n\nDROP DATABASE IF EXISTS sparkdb CASCADE;\nCREATE DATABASE sparkdb;\nUSE sparkdb;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:20:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648127833158_-1400461310","id":"20220324-131713_1711875280","dateCreated":"2022-03-24T13:17:13+0000","dateStarted":"2022-03-24T13:19:40+0000","dateFinished":"2022-03-24T13:19:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25732"},{"title":"Retrieve the data from S3","text":"%sh\n\naws s3 cp s3://shared-edu/dev/tpcds/customer.dat data/tpcds/raw/customer.dat\nhdfs dfs -rm -r /tmp/raw\nhdfs dfs -mkdir -p /tmp/raw\nhdfs dfs -put -f data/tpcds/raw/customer.dat /tmp/raw\nhdfs dfs -chmod -R 777 /tmp/raw/\nhdfs dfs -mkdir -p /tmp/tpcds\nhdfs dfs -chmod 777 /tmp/tpcds","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:28:05+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758390_-1197944534","id":"20210610-153729_1590279960","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:28:06+0000","dateFinished":"2022-03-24T13:28:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25733"},{"text":"%md\n# Lesson\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:07:17+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758391_692607513","id":"20210609-150445_381117564","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:07:17+0000","dateFinished":"2022-03-24T13:07:17+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25734"},{"text":"%md\n## Working with Databases and Tables created with Spark","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:07:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758391_-2101380656","id":"20210610-161419_99149785","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:07:34+0000","dateFinished":"2022-03-24T13:07:34+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25735"},{"title":"Create the database using Spark","text":"%pyspark\n\nspark.sql(\"CREATE DATABASE IF NOT EXISTS sparkdb\")\nspark.sql(\"USE sparkdb\")","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:08:29+0000","config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758392_-1562770303","id":"20210610-153817_965646280","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:08:34+0000","dateFinished":"2022-03-24T13:09:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25736"},{"title":"Create the customer_spark_external external table","text":"%sql\n\nCREATE EXTERNAL TABLE IF NOT EXISTS  customer_spark_external (\n                                        c_customer_sk bigint,\n                                        c_customer_id string,\n                                        c_current_cdemo_sk bigint,\n                                        c_current_hdemo_sk bigint,\n                                        c_current_addr_sk bigint,\n                                        c_first_shipto_date_sk bigint,\n                                        c_first_sales_date_sk bigint,\n                                        c_salutation string,\n                                        c_first_name string,\n                                        c_last_name string,\n                                        c_preferred_cust_flag string,\n                                        c_birth_day int,\n                                        c_birth_month int,\n                                        c_birth_year int,\n                                        c_birth_country string,\n                                        c_login string,\n                                        c_email_address string,\n                                        c_last_review_date string)\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '|'\nSTORED AS TEXTFILE\nLOCATION '/tmp/tpcds/customer'\nTBLPROPERTIES ('external.table.purge'='true')","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:25:21+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758392_1303239750","id":"20210610-154335_1017968138","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:25:09+0000","dateFinished":"2022-03-24T13:25:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25737"},{"title":"Load the data in the external table","text":"%sql\n\nLOAD DATA  INPATH '/tmp/raw/customer.dat' OVERWRITE INTO TABLE customer_spark_external","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:31:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/sql","title":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648128205753_1885576053","id":"20220324-132325_3042519","dateCreated":"2022-03-24T13:23:25+0000","dateStarted":"2022-03-24T13:28:34+0000","dateFinished":"2022-03-24T13:28:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25738"},{"title":"Create the customer_managed managed table","text":"%sql\n\nCREATE TABLE IF NOT EXISTS  customer_spark_managed AS SELECT * FROM customer_spark_external","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:31:15+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758392_857179756","id":"20210610-154951_66099880","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:31:22+0000","dateFinished":"2022-03-24T13:31:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25739"},{"title":"Confirm customer_external is not empty","text":"%sql\n\nSELECT * FROM customer_spark_external","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:32:11+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"c_customer_sk":"string","c_customer_id":"string","c_current_cdemo_sk":"string","c_current_hdemo_sk":"string","c_current_addr_sk":"string","c_first_shipto_date_sk":"string","c_first_sales_date_sk":"string","c_salutation":"string","c_first_name":"string","c_last_name":"string","c_preferred_cust_flag":"string","c_birth_day":"string","c_birth_month":"string","c_birth_year":"string","c_birth_country":"string","c_login":"string","c_email_address":"string","c_last_review_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758393_-2108645831","id":"20210610-161937_1193943797","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:32:12+0000","dateFinished":"2022-03-24T13:32:13+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25740"},{"title":"Confirm customer_managed is not empty too","text":"%sql\n\nSELECT * FROM customer_spark_managed","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:32:27+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"c_customer_sk":"string","c_customer_id":"string","c_current_cdemo_sk":"string","c_current_hdemo_sk":"string","c_current_addr_sk":"string","c_first_shipto_date_sk":"string","c_first_sales_date_sk":"string","c_salutation":"string","c_first_name":"string","c_last_name":"string","c_preferred_cust_flag":"string","c_birth_day":"string","c_birth_month":"string","c_birth_year":"string","c_birth_country":"string","c_login":"string","c_email_address":"string","c_last_review_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758393_-1781153959","id":"20210610-162104_682914758","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:32:27+0000","dateFinished":"2022-03-24T13:32:42+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25741"},{"title":"Inspect customer_external table create statement","text":"%pyspark\n\nspark.sql(\"SHOW CREATE TABLE customer_spark_external\").show(truncate=False)","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:33:11+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"createtab_stmt":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758394_1659930249","id":"20210610-162158_636736467","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:33:20+0000","dateFinished":"2022-03-24T13:33:21+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25742"},{"title":"Inspect customer_managed table create statement","text":"%pyspark\n\nspark.sql(\"SHOW CREATE TABLE customer_spark_managed\").show(truncate=False)","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:33:33+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"createtab_stmt":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758394_-1578508590","id":"20210610-163004_1084404703","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:33:40+0000","dateFinished":"2022-03-24T13:33:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25743"},{"title":"Note","text":"%md\nThe database and tables we created via Spark are considered external by default.\nYou can see the  'TRANSLATED_TO_EXTERNAL' property is set to 'TRUE',\nThus we were able to freely write to and read from those tables.\nTo create a real managed table by Hive, we will need an additional connector.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:33:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758394_675658112","id":"20210610-163646_1234808483","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:33:57+0000","dateFinished":"2022-03-24T13:33:57+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25744"},{"text":"%md\n## Working with Databases and Tables managed by Hive","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:34:17+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758395_1137668593","id":"20210610-165119_575771128","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:34:17+0000","dateFinished":"2022-03-24T13:34:17+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25745"},{"title":"Create the Hive managed database","text":"%jdbc(hive)\n\nDROP DATABASE IF EXISTS hivedb CASCADE;\n\nCREATE DATABASE hivedb;\nUSE hivedb;\n\nCREATE TABLE IF NOT EXISTS  customer_hive_managed (\n                                        c_customer_sk bigint,\n                                        c_customer_id string,\n                                        c_current_cdemo_sk bigint,\n                                        c_current_hdemo_sk bigint,\n                                        c_current_addr_sk bigint,\n                                        c_first_shipto_date_sk bigint,\n                                        c_first_sales_date_sk bigint,\n                                        c_salutation string,\n                                        c_first_name string,\n                                        c_last_name string,\n                                        c_preferred_cust_flag string,\n                                        c_birth_day int,\n                                        c_birth_month int,\n                                        c_birth_year int,\n                                        c_birth_country string,\n                                        c_login string,\n                                        c_email_address string,\n                                        c_last_review_date string);\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:35:05+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true,"tableHide":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758395_-1466140533","id":"20210610-182949_2092922624","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:34:59+0000","dateFinished":"2022-03-24T13:35:01+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25746"},{"title":"Confirm successful creation of the database and table","text":"%pyspark\n\nspark.sql(\"show databases\").show()\nspark.sql(\"use hivedb\")\nspark.sql(\"show tables\").show()","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:35:14+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758396_-1579516496","id":"20210610-173143_21214750","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:35:15+0000","dateFinished":"2022-03-24T13:35:16+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25747"},{"title":"Inspect customer_hive_managed table create statement","text":"%pyspark\n\nspark.sql(\"SHOW CREATE TABLE hivedb.customer_hive_managed\").show(truncate=False)","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:36:17+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"createtab_stmt":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758396_-96972456","id":"20210610-173035_35099086","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:36:18+0000","dateFinished":"2022-03-24T13:36:19+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25748"},{"title":"Note","text":"%md\nThe table is stored using the ORC format and it is 'transactional'.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:36:30+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758397_-745848549","id":"20210610-183618_1087770970","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:36:30+0000","dateFinished":"2022-03-24T13:36:30+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25749"},{"title":"Can Spark access that table? No","text":"%md\n\nSELECT * FROM customer_hive_managed\n\n```\norg.apache.spark.sql.AnalysisException:\nSpark has no access to table `hivedb`.`customer_hive_managed`. Clients can access this table only if\nthey have the following capabilities: CONNECTORREAD,HIVEFULLACIDREAD,HIVEFULLACIDWRITE,HIVEMANAGESTATS,HIVECACHEINVALIDATE,CONNECTORWRITE.\nThis table may be a Hive-managed ACID table, or require some other capability that Spark\ncurrently does not implement\n...\n```\n\nThere used to be a solution called the Hive Warehouse Connector with Spark 2, it seems that it has not been carried over to Spark 3.\nThere are projects in progress to plug that gap but no solution has emerged yet.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:42:32+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758397_2009153422","id":"20210610-155114_889357531","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:42:32+0000","dateFinished":"2022-03-24T13:42:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25750"},{"title":"Can Hive access the tables created using Spark? Yes","text":"%jdbc(hive)\n\nSELECT * FROM sparkdb.customer_spark_managed LIMIT 5;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:43:47+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"customer_spark_managed.c_customer_sk":"string","customer_spark_managed.c_customer_id":"string","customer_spark_managed.c_current_cdemo_sk":"string","customer_spark_managed.c_current_hdemo_sk":"string","customer_spark_managed.c_current_addr_sk":"string","customer_spark_managed.c_first_shipto_date_sk":"string","customer_spark_managed.c_first_sales_date_sk":"string","customer_spark_managed.c_salutation":"string","customer_spark_managed.c_first_name":"string","customer_spark_managed.c_last_name":"string","customer_spark_managed.c_preferred_cust_flag":"string","customer_spark_managed.c_birth_day":"string","customer_spark_managed.c_birth_month":"string","customer_spark_managed.c_birth_year":"string","customer_spark_managed.c_birth_country":"string","customer_spark_managed.c_login":"string","customer_spark_managed.c_email_address":"string","customer_spark_managed.c_last_review_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758397_1044714821","id":"20210610-185601_457928486","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:43:48+0000","dateFinished":"2022-03-24T13:43:50+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25751"},{"text":"%md\n\nFor the time being, the best practice is to transform and load your data using Spark in a staging area of Hive and then create the corresponding managed tables using HiveQL CTAS statements.\n\nBut watch this space as this is a fast evolving area of Spark.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:44:02+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758398_1924557008","id":"20210610-190741_604696368","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:44:02+0000","dateFinished":"2022-03-24T13:44:02+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25752"},{"text":"%md\n# Lab\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:44:23+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758398_-1886259876","id":"20210609-150527_79851234","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:44:23+0000","dateFinished":"2022-03-24T13:44:23+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25753"},{"title":"1- Create a staging database called 'staging' with Spark and use it","text":"%pyspark\n\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:45:03+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758398_-1113613806","id":"20210610-192203_1082805184","dateCreated":"2022-03-24T12:59:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25754"},{"text":"%md\n\nCreate a customer table using the following statement:\n```sql\nCREATE EXTERNAL TABLE IF NOT EXISTS  customer (\n                                        c_customer_sk bigint,\n                                        c_customer_id string,\n                                        c_current_cdemo_sk bigint,\n                                        c_current_hdemo_sk bigint,\n                                        c_current_addr_sk bigint,\n                                        c_first_shipto_date_sk bigint,\n                                        c_first_sales_date_sk bigint,\n                                        c_salutation string,\n                                        c_first_name string,\n                                        c_last_name string,\n                                        c_preferred_cust_flag string,\n                                        c_birth_day int,\n                                        c_birth_month int,\n                                        c_birth_year int,\n                                        c_birth_country string,\n                                        c_login string,\n                                        c_email_address string,\n                                        c_last_review_date string)\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '|'\nSTORED AS TEXTFILE\nLOCATION '/tmp/tpcds/customer'\nTBLPROPERTIES ('external.table.purge'='true')\n```","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:54:08+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758399_-551498387","id":"20210610-191228_1179888553","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:54:08+0000","dateFinished":"2022-03-24T13:54:08+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25755"},{"title":"2 - Create a customer staging table","text":"%sql\n\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:46:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758399_813338466","id":"20210610-192844_1760082518","dateCreated":"2022-03-24T12:59:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25756"},{"title":"3 - Confirm successful creation","text":"%sql\n\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:48:22+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"c_customer_sk":"string","c_customer_id":"string","c_current_cdemo_sk":"string","c_current_hdemo_sk":"string","c_current_addr_sk":"string","c_first_shipto_date_sk":"string","c_first_sales_date_sk":"string","c_salutation":"string","c_first_name":"string","c_last_name":"string","c_preferred_cust_flag":"string","c_birth_day":"string","c_birth_month":"string","c_birth_year":"string","c_birth_country":"string","c_login":"string","c_email_address":"string","c_last_review_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758400_819496070","id":"20210610-193207_1068973261","dateCreated":"2022-03-24T12:59:18+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25757"},{"title":"4 - Create a 'prod' database using jdbc","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:49:10+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758400_-1905328812","id":"20210610-193846_1050835050","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:49:17+0000","dateFinished":"2022-03-24T13:49:17+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25758"},{"title":"5 - Use a CTAS statement to create a customer managed table in the prod database","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:49:35+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758400_-108507775","id":"20210610-193236_827474300","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:49:36+0000","dateFinished":"2022-03-24T13:49:36+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25759"},{"title":"6 - Confirm successful creation of the prod.customer table","text":"%jdbc(hive)\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:49:23+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758401_-584294232","id":"20210610-200238_209496604","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:49:25+0000","dateFinished":"2022-03-24T13:49:25+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25760"},{"text":"%md\n# Result\n**You have now:** become familiar with Spark operations using Hive \n\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:49:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758401_-475875853","id":"20181119-142716_792318228","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:49:47+0000","dateFinished":"2022-03-24T13:49:47+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25761"},{"text":"%md\n# Solution\n---","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:53:31+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758402_600834822","id":"20171113-155535_1769142099","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:53:31+0000","dateFinished":"2022-03-24T13:53:31+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25762"},{"title":"1- Create a staging database called 'staging' with Spark and use it","text":"%pyspark\n\nspark.sql(\"CREATE DATABASE IF NOT EXISTS staging\").show()\nspark.sql(\"USE staging\")","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:53:40+0000","config":{"tableHide":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758402_359153626","id":"20210610-192314_641294940","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:53:43+0000","dateFinished":"2022-03-24T13:53:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25763"},{"title":"2 - Create a customer staging table","text":"%sql\n\nCREATE EXTERNAL TABLE IF NOT EXISTS  customer (\n                                        c_customer_sk bigint,\n                                        c_customer_id string,\n                                        c_current_cdemo_sk bigint,\n                                        c_current_hdemo_sk bigint,\n                                        c_current_addr_sk bigint,\n                                        c_first_shipto_date_sk bigint,\n                                        c_first_sales_date_sk bigint,\n                                        c_salutation string,\n                                        c_first_name string,\n                                        c_last_name string,\n                                        c_preferred_cust_flag string,\n                                        c_birth_day int,\n                                        c_birth_month int,\n                                        c_birth_year int,\n                                        c_birth_country string,\n                                        c_login string,\n                                        c_email_address string,\n                                        c_last_review_date string)\nROW FORMAT DELIMITED \nFIELDS TERMINATED BY '|'\nSTORED AS TEXTFILE\nLOCATION '/tmp/tpcds/customer'\nTBLPROPERTIES ('external.table.purge'='true')","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:54:30+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{}},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758402_1372282086","id":"20210610-192930_1733423333","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:54:31+0000","dateFinished":"2022-03-24T13:54:32+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25764"},{"title":"3 - Confirm successful creation","text":"%sql\n\nSELECT * FROM customer LIMIT 5","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:54:40+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"c_customer_sk":"string","c_customer_id":"string","c_current_cdemo_sk":"string","c_current_hdemo_sk":"string","c_current_addr_sk":"string","c_first_shipto_date_sk":"string","c_first_sales_date_sk":"string","c_salutation":"string","c_first_name":"string","c_last_name":"string","c_preferred_cust_flag":"string","c_birth_day":"string","c_birth_month":"string","c_birth_year":"string","c_birth_country":"string","c_login":"string","c_email_address":"string","c_last_review_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758403_-927951923","id":"20210610-192956_1991023889","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:54:43+0000","dateFinished":"2022-03-24T13:54:44+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25765"},{"title":"4 - Create a 'prod' database using jdbc","text":"%jdbc(hive)\n\nCREATE DATABASE IF NOT EXISTS  prod;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:54:55+0000","config":{"tableHide":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758403_1871476255","id":"20210610-193947_1036469973","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:54:55+0000","dateFinished":"2022-03-24T13:54:56+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25766"},{"title":"5 - Use a CTAS statement to create a customer managed table in the prod database","text":"%jdbc(hive)\n\nCREATE TABLE IF NOT EXISTS  prod.customer AS SELECT * FROM staging.customer;","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:55:03+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758403_910144546","id":"20210610-193412_217417052","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:55:09+0000","dateFinished":"2022-03-24T13:56:49+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25767"},{"title":"6 - Confirm successful creation of the prod.customer table","text":"%jdbc(hive)\n\nSELECT * FROM prod.customer LIMIT 5","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:58:51+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"customer.c_customer_sk":"string","customer.c_customer_id":"string","customer.c_current_cdemo_sk":"string","customer.c_current_hdemo_sk":"string","customer.c_current_addr_sk":"string","customer.c_first_shipto_date_sk":"string","customer.c_first_sales_date_sk":"string","customer.c_salutation":"string","customer.c_first_name":"string","customer.c_last_name":"string","customer.c_preferred_cust_flag":"string","customer.c_birth_day":"string","customer.c_birth_month":"string","customer.c_birth_year":"string","customer.c_birth_country":"string","customer.c_login":"string","customer.c_email_address":"string","customer.c_last_review_date":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758404_-1907990934","id":"20210610-200322_1629064438","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:58:52+0000","dateFinished":"2022-03-24T13:58:52+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25768"},{"title":"Additional resources","text":"%md\nWe hope you've enjoyed this lab. Below are additional resources that you should find useful:\n\n1. [Cloudera Tutorials](http://cloudera.com/tutorials.html) are your natural next step where you can explore Spark in more depth.\n2. [Cloudera Community](https://community.cloudera.com) is a great resource for questions and answers on Spark, Data Analytics/Science, and many more Big Data topics.\n3. [Apache Spark Documentation](https://spark.apache.org/documentation.html) - official Spark documentation.\n4. [Apache Zeppelin Project Home Page](https://zeppelin.apache.org) - official Zeppelin web site.","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:59:37+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":10,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758405_-745343393","id":"20181116-135131_93712280","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:59:37+0000","dateFinished":"2022-03-24T13:59:37+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25769"},{"text":"%angular\n</br>\n</br>\n</br>\n</br>\n<center>\n<a href=\"https://www.cloudera.com/about/training/courses.html\">\n  <img src=\"https://www.cloudera.com/content/dam/www/marketing/media-kit/logo-assets/cloudera_logo_darkorange.png\" alt=\"Cloudera University\" style=\"width:280px;height:40px;border:0;\" align=\"middle\">\n</a>\n</center>\n</br>\n</br>","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T13:59:42+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":2,"editorMode":"ace/mode/undefined","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758405_-1214464962","id":"20200110-154537_1406191376","dateCreated":"2022-03-24T12:59:18+0000","dateStarted":"2022-03-24T13:59:42+0000","dateFinished":"2022-03-24T13:59:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25770"},{"text":"%angular\n","user":"freynalddeveuwest1","dateUpdated":"2022-03-24T12:59:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/undefined","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1648126758406_1300266524","id":"20200110-162013_302547143","dateCreated":"2022-03-24T12:59:18+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:25771"}],"name":"DE/Labs/Pyspark/SparkIntegrationWithHive","id":"2GYV9NNVA","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"angular:shared_process":[],"sh:shared_process":[],"jdbc:shared_process":[],"livy:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}